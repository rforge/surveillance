<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Continuous-Time SIR Event History of a Fixed Population — epidata • surveillance</title>
<script src="../deps/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="../deps/bs3compat-0.2.4/tabs.js"></script><script src="../deps/bs3compat-0.2.4/bs3compat.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css">
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<link href="../syntax-highlighting.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Continuous-Time SIR Event History of a Fixed Population — epidata">
<meta property="og:description" content='The function as.epidata is used to generate objects
  of class "epidata".  Objects of this class are
  specific data frames containing the event history of an epidemic together
  with some additional attributes.  These objects are the basis for fitting
  spatio-temporal epidemic intensity models with the function
  twinSIR.  Their implementation is illustrated in Meyer
  et al. (2017, Section 4), see vignette("twinSIR").
  Note that the spatial information itself, i.e.
  the positions of the individuals, is assumed to be constant over time.  
  Besides epidemics following the SIR compartmental model, also data from SI,
  SIRS and SIS epidemics may be supplied.'>
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@bastistician">
<meta name="twitter:site" content="@bastistician">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc" data-headroom data-tolerance="5" data-offset="100">
    

      <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a class="navbar-brand mb-0 h1" href="../index.html">surveillance</a>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <button type="button" id="version-badge" class="badge badge-default d-none d-lg-block" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Released version">1.19.1</button>

    <div id="navbar" class="collapse navbar-collapse">
      <ul class="navbar-nav mr-auto ml-3">
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/overview.html">Overview</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/events.html">Events</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/bibliography.html">Bibliography</a>
</li>
      </ul>
<ul class="navbar-nav ml-1"></ul>
</div>
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header pb-2 mt-4 mb-2 border-bottom toc-ignore">
    <h1 class="display-4">Continuous-Time SIR Event History of a Fixed Population</h1>
    
    <div class="d-none name"><code>epidata.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function <code>as.epidata</code> is used to generate objects
  of class <code>"epidata"</code>.  Objects of this class are
  specific data frames containing the event history of an epidemic together
  with some additional attributes.  These objects are the basis for fitting
  spatio-temporal epidemic intensity models with the function
  <code><a href="twinSIR.html">twinSIR</a></code>.  Their implementation is illustrated in Meyer
  et al. (2017, Section 4), see <code>vignette("twinSIR")</code>.
  Note that the spatial information itself, i.e.
  the positions of the individuals, is assumed to be constant over time.  
  Besides epidemics following the SIR compartmental model, also data from SI,
  SIRS and SIS epidemics may be supplied.</p>
    </div>

    <pre class="usage"><code class="sourceCode R">as.epidata(data, ...)

# S3 method for data.frame
as.epidata(data, t0,
           tE.col, tI.col, tR.col, id.col, coords.cols,
           f = list(), w = list(), D = dist,
           max.time = NULL, keep.cols = TRUE, ...)
# S3 method for default
as.epidata(data, id.col, start.col, stop.col,
           atRiskY.col, event.col, Revent.col, coords.cols,
           f = list(), w = list(), D = dist, .latent = FALSE, ...)

# S3 method for epidata
print(x, ...)
# S3 method for epidata
[(x, i, j, drop)
# S3 method for epidata
update(object, f = list(), w = list(), D = dist, ...)</code></pre>

    <h2>Arguments</h2>
    <dl class="row" id="ref-arguments">
<dt class="col-sm-3" id="ref-arguments name">data</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>For the <code>data.frame</code>-method, a data frame with as many rows as
    there are individuals in the population and time columns indicating
    when each individual became exposed (optional), infectious
    (mandatory, but can be <code>NA</code> for non-affected individuals) and
    removed (optional). Note that this data format does not allow for
    re-infection (SIRS) and time-varying covariates.
    The <code>data.frame</code>-method converts the individual-indexed data
    frame to the long event history start/stop format and then feeds it
    into the default method. If calling the generic function
    <code>as.epidata</code> on a <code>data.frame</code> and the <code>t0</code> argument
    is missing, the default method is called directly.<br>
    For the default method, <code>data</code> can be a <code><a href="https://rdrr.io/r/base/matrix.html">matrix</a></code> or
    a <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></code>.
    It must contain the observed event history in a form similar to 
    <code>Surv(, type="counting")</code> in package <span class="pkg">survival</span>,
    with additional information (variables) along 
    the process.  Rows will be sorted automatically during conversion.
    The observation period is split up into <em>consecutive</em>
    intervals of constant state - thus constant infection intensities.
    The data frame consists of a block of \(N\) (number of individuals) 
    rows for each of those time intervals (all rows in a block have the same start 
    and stop values... therefore the name “block”), where there is one 
    row per individual in the block.  Each row describes the (fixed) state of 
    the individual during the interval given by the start and stop columns 
    <code>start.col</code> and <code>stop.col</code>.<br>
    Note that there may not be more than one event (infection or removal) in a
    single block.  Thus, in a single block, only one entry in the 
    <code>event.col</code> and <code>Revent.col</code> may be 1, all others are 0.  This
    rule follows the point process characteristic that there are no
    concurrent events (infections or removals).</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">t0,max.time</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>observation period. In the resulting <code>"epidata"</code>, the time
    scale will be relative to the start time <code>t0</code>.
    Individuals that have already been removed prior to <code>t0</code>, i.e.,
    rows with <code>tR &lt;= t0</code>, will be dropped.
    The end of the observation period (<code>max.time</code>) will by default
    (<code>NULL</code>, or if <code>NA</code>) coincide with the last observed event.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">tE.col, tI.col, tR.col</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>single numeric or character indexes of the time columns in
    <code>data</code>, which specify when the individuals became exposed,
    infectious and removed, respectively.
    <code>tE.col</code> and <code>tR.col</code> can be missing, corresponding to
    SIR, SEI, or SI data. <code>NA</code> entries mean that the respective
    event has not (yet) occurred. Note that <code><a href="https://rdrr.io/r/base/NA.html">is.na(tE)</a></code> implies
    <code><a href="https://rdrr.io/r/base/NA.html">is.na(tI)</a></code> and <code><a href="https://rdrr.io/r/base/NA.html">is.na(tR)</a></code>, and <code><a href="https://rdrr.io/r/base/NA.html">is.na(tI)</a></code> implies
    <code><a href="https://rdrr.io/r/base/NA.html">is.na(tR)</a></code> (and this is checked for the provided data).<br>
    CAVE: Support for latent periods (<code>tE.col</code>) is experimental!
          <code><a href="twinSIR.html">twinSIR</a></code> cannot handle them anyway.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">id.col</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>single numeric or character index of the <code>id</code> column in <code>data</code>.
    The <code>id</code> column identifies the individuals in the data frame.
    It is converted to a factor by calling <code><a href="https://rdrr.io/r/base/factor.html">factor</a></code>, i.e.,
    unused levels are dropped if it already was a factor.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">start.col</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>single index of the <code>start</code> column in <code>data</code>.  Can be numeric
    (by column number) or character (by column name).
    The <code>start</code> column contains the (numeric) time points of the beginnings
    of the consecutive time intervals of the event history.  The minimum value
    in this column, i.e. the start of the observation period should be 0.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">stop.col</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>single index of the <code>stop</code> column in <code>data</code>.  Can be numeric
    (by column number) or character (by column name).
    The <code>stop</code> column contains the (numeric) time points of the ends
    of the consecutive time intervals of the event history.  The stop value must
    always be greater than the start value of a row.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">atRiskY.col</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>single index of the <code>atRiskY</code> column in <code>data</code>.  Can be numeric
    (by column number) or character (by column name).
    The <code>atRiskY</code> column indicates if the individual was “at-risk”
    of becoming infected during the time interval (start; stop].  This variable 
    must be logical or in 0/1-coding.
    Individuals with <code>atRiskY == 0</code> in the first time interval (normally 
    the rows with <code>start == 0</code>) are taken as <em>initially infectious</em>.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">event.col</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>single index of the <code>event</code> column in <code>data</code>.  Can be numeric
    (by column number) or character (by column name).
    The <code>event</code> column indicates if the individual became <em>infected</em>
    at the <code>stop</code> time of the interval.  This variable must be logical or
    in 0/1-coding.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">Revent.col</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>single index of the <code>Revent</code> column in <code>data</code>.  Can be numeric
    (by column number) or character (by column name).
    The <code>Revent</code> column indicates if the individual was <em>recovered</em> 
    at the <code>stop</code> time of the interval.  This variable must be logical or
    in 0/1-coding.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">coords.cols</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>index<em>es</em> of the <code>coords</code> column<em>s</em> in <code>data</code>. Can be
    numeric (by column number), character (by column name), or <code>NULL</code>
    (no coordinates, e.g., if <code>D</code> is a pre-specified distance matrix).
    These columns contain the individuals' coordinates, which determine
    the distance matrix for the distance-based components of the force
    of infection (see argument <code>f</code>). By default, Euclidean distance
    is used (see argument <code>D</code>).<br>
    Note that the functions related to <code><a href="twinSIR.html">twinSIR</a></code> currently assume
    <em>fixed positions</em> of the individuals during the whole epidemic.  Thus, an
    individual has the same coordinates in every block.  For simplicity, the
    coordinates are derived from the first time block only (normally the rows 
    with <code>start == 0</code>).<br>
    The <code><a href="epidata_animate.html">animate</a></code>-method requires coordinates.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">f</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>a <em>named</em> list of <em>vectorized</em> functions for a
    distance-based force of infection.
    The functions must interact elementwise on a (distance) matrix <code>D</code> so that
    <code>f[[m]](D)</code> results in a matrix.  A simple example is
    <code>function(u) {u &lt;= 1}</code>, which indicates if the Euclidean distance
    between the individuals is smaller than or equal to 1.
    The names of the functions determine the names of the epidemic variables
    in the resulting data frame.  So, the names should not coincide with
    names of other covariates.
    The distance-based weights are computed as follows:
    Let \(I(t)\) denote the set of infectious
    individuals just before time \(t\).
    Then, for individual \(i\) at time \(t\), the
    \(m\)'th covariate has the value
    \(\sum_{j \in I(t)} f_m(d_{ij})\),
    where \(d_{ij}\) denotes entries of the distance matrix
    (by default this is the Euclidean distance \(||s_i - s_j||\)
    between the individuals' coordinates, but see argument <code>D</code>).</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">w</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>a <em>named</em> list of <em>vectorized</em> functions for extra 
    covariate-based weights \(w_{ij}\) in the epidemic component.
    Each function operates on a single time-constant covariate in
    <code>data</code>, which is determined by the name of the first argument:
    The two function arguments should be named <code>varname.i</code> and
    <code>varname.j</code>, where <code>varname</code> is one of <code><a href="https://rdrr.io/r/base/names.html">names(data)</a></code>.
    Similar to the components in <code>f</code>, <code><a href="https://rdrr.io/r/base/length.html">length(w)</a></code> epidemic
    covariates will be generated in the resulting <code>"epidata"</code> named
    according to <code><a href="https://rdrr.io/r/base/names.html">names(w)</a></code>.  So, the names should not coincide with
    names of other covariates.  For individual \(i\) at time
    \(t\), the \(m\)'th such covariate has the value
    \(\sum_{j \in I(t)} w_m(z^{(m)}_i, z^{(m)}_j)\),
    where \(z^{(m)}\) denotes the variable in <code>data</code> associated
    with <code>w[[m]]</code>.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">D</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>either a function to calculate the distances between the individuals
    with locations taken from <code>coord.cols</code> (the default is
    Euclidean distance via the function <code><a href="https://rdrr.io/r/stats/dist.html">dist</a></code>) and
    the result converted to a matrix via <code><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></code>,
    or a pre-computed distance matrix with <code>dimnames</code> containing
    the individual ids (a classed <code>"Matrix"</code> is supported).</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">keep.cols</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>logical indicating if all columns in <code>data</code>
    should be retained (and not only the obligatory <code>"epidata"</code>
    columns), in particular any additional columns with 
    time-constant individual-specific covariates.
    Alternatively, <code>keep.cols</code> can be a numeric or character vector
    indexing columns of <code>data</code> to keep.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">.latent</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>(internal) logical indicating whether to allow for latent periods
    (EXPERIMENTAL). Otherwise (default), the function verifies that an
    event (i.e., switching to the I state) only happens when the
    respective individual is at risk (i.e., in the S state).</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">x,object</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>an object of class <code>"epidata"</code>.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">...</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>arguments passed to <code><a href="https://rdrr.io/r/base/print.dataframe.html">print.data.frame</a></code>. Currently unused
    in the <code>as.epidata</code>-methods.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">i,j,drop</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>arguments passed to <code><a href="https://rdrr.io/r/base/Extract.data.frame.html">[.data.frame</a></code>.</p></dd>
    </dl>
<h2 class="hasAnchor" id="details">
<a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>print</code> method for objects of class <code>"epidata"</code> simply prints
  the data frame with a small header containing the time range of the observed
  epidemic and the number of infected individuals.  Usually, the data frames
  are quite long, so the summary method <code><a href="epidata_summary.html">summary.epidata</a></code> might be
  useful.  Also, indexing/subsetting <code>"epidata"</code> works exactly as for
  <code><a href="https://rdrr.io/r/base/Extract.data.frame.html">data.frame</a></code>s, but there is an own method, which
  assures consistency of the resulting <code>"epidata"</code> or drops this class, if
  necessary.
  The <code>update</code>-method can be used to add or replace distance-based
  (<code>f</code>) or covariate-based (<code>w</code>) epidemic variables in an
  existing <code>"epidata"</code> object.</p>  
<p>SIS epidemics are implemented as SIRS epidemics where the length of the
  removal period equals 0.  This means that an individual, which has an R-event
  will be at risk immediately afterwards, i.e. in the following time block.
  Therefore, data of SIS epidemics have to be provided in that form containing
  “pseudo-R-events”.</p>
    <h2 class="hasAnchor" id="note">
<a class="anchor" href="#note"></a>Note</h2>

    <p>The column name <code>"BLOCK"</code> is a reserved name.  This column will be 
  added automatically at conversion and the resulting data frame will be 
  sorted by this column and by id.  Also the names <code>"id"</code>, <code>"start"</code>,
  <code>"stop"</code>, <code>"atRiskY"</code>, <code>"event"</code> and <code>"Revent"</code> are
  reserved for the respective columns only.</p>
    <h2 class="hasAnchor" id="value">
<a class="anchor" href="#value"></a>Value</h2>

    <p>a <code>data.frame</code> with the columns <code>"BLOCK"</code>, <code>"id"</code>,
  <code>"start"</code>, <code>"stop"</code>, <code>"atRiskY"</code>, <code>"event"</code>,
  <code>"Revent"</code> and the coordinate columns (with the original names from
  <code>data</code>), which are all obligatory.  These columns are followed by any 
  remaining columns of the input <code>data</code>.  Last but not least, the newly
  generated columns with epidemic variables corresponding to the functions
  in the list <code>f</code> are appended, if <code><a href="https://rdrr.io/r/base/length.html">length(f)</a></code> &gt; 0.</p>  
<p>The <code>data.frame</code> is given the additional <em>attributes</em></p>
<dt>"eventTimes"</dt>
<dd><p>numeric vector of infection time points (sorted chronologically).</p></dd>
  <dt>"timeRange"</dt>
<dd><p>numeric vector of length 2: <code><a href="https://rdrr.io/r/base/c.html">c(min(start), max(stop))</a></code>.</p></dd>
  <dt>"coords.cols"</dt>
<dd><p>numeric vector containing the column indices of the coordinate columns in
    the resulting data frame.</p></dd>
  <dt>"f"</dt>
<dd><p>this equals the argument <code>f</code>.</p></dd>
  <dt>"w"</dt>
<dd><p>this equals the argument <code>w</code>.</p></dd>

    <h2 class="hasAnchor" id="author">
<a class="anchor" href="#author"></a>Author</h2>

    <p>Sebastian Meyer</p>
    <h2 class="hasAnchor" id="see-also">
<a class="anchor" href="#see-also"></a>See also</h2>

    <div class="dont-index">
<p>The <code><a href="hagelloch.html">hagelloch</a></code> data as an example.</p>
<p>The <code><a href="epidata_plot.html">plot</a></code> and the
<code><a href="epidata_summary.html">summary</a></code> method for class <code>"epidata"</code>.
Furthermore, the function <code><a href="epidata_animate.html">animate.epidata</a></code> for the animation of
epidemics.</p>
<p>Function <code><a href="twinSIR.html">twinSIR</a></code> for fitting spatio-temporal epidemic intensity
models to epidemic data.</p>
<p>Function <code><a href="twinSIR_simulation.html">simEpidata</a></code> for the simulation of epidemic data.</p>
</div>
    <h2 class="hasAnchor" id="references">
<a class="anchor" href="#references"></a>References</h2>

    <p>Meyer, S., Held, L. and Höhle, M. (2017):
  Spatio-temporal analysis of epidemic phenomena using the <span style="R">R</span> package
  <span class="pkg">surveillance</span>.
  <em>Journal of Statistical Software</em>, <b>77</b> (11), 1-55.
  doi: <a href="https://doi.org/10.18637/jss.v077.i11">10.18637/jss.v077.i11</a></p>

    <h2 class="hasAnchor" id="examples">
<a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"hagelloch"</span><span class="op">)</span>   <span class="co"># see help("hagelloch") for a description</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">hagelloch.df</span><span class="op">)</span>

<span class="co">## convert the original data frame to an "epidata" event history</span>
<span class="va">myEpi</span> <span class="op">&lt;-</span> <span class="fu">as.epidata</span><span class="op">(</span><span class="va">hagelloch.df</span>, t0 <span class="op">=</span> <span class="fl">0</span>,
                    tI.col <span class="op">=</span> <span class="st">"tI"</span>, tR.col <span class="op">=</span> <span class="st">"tR"</span>, id.col <span class="op">=</span> <span class="st">"PN"</span>,
                    coords.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x.loc"</span>, <span class="st">"y.loc"</span><span class="op">)</span>,
                    keep.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"SEX"</span>, <span class="st">"AGE"</span>, <span class="st">"CL"</span><span class="op">)</span><span class="op">)</span>
<span class="co"># \dontshow{</span>
<span class="co">## test consistency with default method</span>
<span class="va">evHist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">myEpi</span><span class="op">)</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>
<span class="va">myEpi2</span> <span class="op">&lt;-</span> <span class="fu">as.epidata</span><span class="op">(</span>
    <span class="va">evHist</span>, id.col <span class="op">=</span> <span class="fl">1</span>, start.col <span class="op">=</span> <span class="st">"start"</span>, stop.col <span class="op">=</span> <span class="st">"stop"</span>,
    atRiskY.col <span class="op">=</span> <span class="st">"atRiskY"</span>, event.col <span class="op">=</span> <span class="st">"event"</span>, Revent.col <span class="op">=</span> <span class="st">"Revent"</span>,
    coords.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x.loc"</span>, <span class="st">"y.loc"</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span><span class="op">(</span><span class="va">myEpi</span>, <span class="va">myEpi2</span><span class="op">)</span><span class="op">)</span>
<span class="co"># }</span>

<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">myEpi</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">myEpi</span><span class="op">)</span><span class="op">)</span>  <span class="co"># "epidata" has event history format</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">myEpi</span><span class="op">)</span>              <span class="co"># see 'summary.epidata'</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">myEpi</span><span class="op">)</span>                 <span class="co"># see 'plot.epidata' and also 'animate.epidata'</span>

<span class="co">## add distance- and covariate-based weights for the force of infection</span>
<span class="co">## in a twinSIR model, see vignette("twinSIR") for a description</span>
<span class="va">myEpi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">myEpi</span>,
    f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        household    <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="va">u</span> <span class="op">==</span> <span class="fl">0</span>,
        nothousehold <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="va">u</span> <span class="op">&gt;</span> <span class="fl">0</span>
    <span class="op">)</span>,
    w <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        c1 <span class="op">=</span> <span class="kw">function</span> <span class="op">(</span><span class="va">CL.i</span>, <span class="va">CL.j</span><span class="op">)</span> <span class="va">CL.i</span> <span class="op">==</span> <span class="st">"1st class"</span> <span class="op">&amp;</span> <span class="va">CL.j</span> <span class="op">==</span> <span class="va">CL.i</span>,
        c2 <span class="op">=</span> <span class="kw">function</span> <span class="op">(</span><span class="va">CL.i</span>, <span class="va">CL.j</span><span class="op">)</span> <span class="va">CL.i</span> <span class="op">==</span> <span class="st">"2nd class"</span> <span class="op">&amp;</span> <span class="va">CL.j</span> <span class="op">==</span> <span class="va">CL.i</span>
    <span class="op">)</span>
<span class="op">)</span>
<span class="co">## this is now identical to the prepared hagelloch "epidata"</span>
<span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">myEpi</span>, <span class="va">hagelloch</span><span class="op">)</span><span class="op">)</span>

<span class="co"># \dontshow{</span>
<span class="co">## test with precomputed distance matrix D</span>
<span class="va">myEpi3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span><span class="op">(</span> <span class="co"># from overwriting existing f columns</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">hagelloch</span>, f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">hagelloch</span>, <span class="st">"f"</span><span class="op">)</span>,
           D <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">hagelloch.df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x.loc"</span>, <span class="st">"y.loc"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span><span class="op">(</span><span class="va">hagelloch</span>, <span class="va">myEpi3</span><span class="op">)</span><span class="op">)</span>
<span class="co"># }</span>
</code></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="sticky-top">
    <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>

    </nav>
</div>
  </div>
</div>


      <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Maintained by <a href="http://www.imbe.med.uni-erlangen.de/cms/sebastian_meyer.html" class="external-link">Sebastian Meyer</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

