<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Semiparametric surveillance of outbreaks — algo.outbreakP • surveillance</title>
<script src="../deps/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="../deps/bs3compat-0.2.4/tabs.js"></script><script src="../deps/bs3compat-0.2.4/bs3compat.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css">
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<link href="../syntax-highlighting.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Semiparametric surveillance of outbreaks — algo.outbreakP">
<meta property="og:description" content="Frisen and Andersson (2009) method for semiparametric surveillance of outbreaks">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@bastistician">
<meta name="twitter:site" content="@bastistician">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc" data-headroom data-tolerance="5" data-offset="100">
    

      <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a class="navbar-brand mb-0 h1" href="../index.html">surveillance</a>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <button type="button" id="version-badge" class="badge badge-default d-none d-lg-block" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Released version">1.19.1</button>

    <div id="navbar" class="collapse navbar-collapse">
      <ul class="navbar-nav mr-auto ml-3">
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/overview.html">Overview</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/events.html">Events</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/bibliography.html">Bibliography</a>
</li>
      </ul>
<ul class="navbar-nav ml-1"></ul>
</div>
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header pb-2 mt-4 mb-2 border-bottom toc-ignore">
    <h1 class="display-4">Semiparametric surveillance of outbreaks</h1>
    
    <div class="d-none name"><code>algo.outbreakP.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Frisen and Andersson (2009) method for semiparametric surveillance of outbreaks</p>
    </div>

    <pre class="usage"><code class="sourceCode R"><span class="fu">algo.outbreakP</span><span class="op">(</span><span class="va">disProgObj</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>range <span class="op">=</span> <span class="va">range</span>, k<span class="op">=</span><span class="fl">100</span>,
               ret<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cases"</span>,<span class="st">"value"</span><span class="op">)</span>,maxUpperboundCases<span class="op">=</span><span class="fl">1e5</span><span class="op">)</span><span class="op">)</span></code></pre>

    <h2>Arguments</h2>
    <dl class="row" id="ref-arguments">
<dt class="col-sm-3" id="ref-arguments name">disProgObj</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>object of class disProg (including the observed and the state chain).</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">control</dt>
      <dd class="col-sm-9" id="ref-arguments desc">
<p>A list controlling the behaviour of the algorithm</p>
<dl>
<dt><code>range</code></dt>
<dd><p>determines the desired
        time-points which should be monitored. Note that it is
        automatically assumed that ALL other values in <code>disProgObj</code>
        can be used for the estimation, i.e. for a specific value <code>i</code>
        in <code>range</code> all values from 1 to <code>i</code> are used for estimation.</p></dd>
    <dt><code>k</code></dt>
<dd><p>The threshold value. Once the outbreak statistic
        is above this threshold <code>k</code> an alarm is sounded.</p></dd>
    <dt><code>ret</code></dt>
<dd><p>a string specifying the type of
        <code>upperbound</code>-statistic that is returned. With
        <code>"cases"</code> the number of cases that would have been
        necessary to produce an alarm (NNBA) or with <code>"value"</code> the
        outbreakP-statistic is computed (see below).</p></dd>
    <dt><code>maxUpperboundCases</code></dt>
<dd><p>Upperbound when numerically searching
        for NNBA. Default is 1e5.</p></dd>
    
</dl>
<p></p>
</dd>
    </dl>
<h2 class="hasAnchor" id="value">
<a class="anchor" href="#value"></a>Value</h2>

    <p><code>algo.outbreakP</code> gives a list of class <code>survRes</code> which
  includes the vector of alarm values for every time-point in
  <code>range</code>, the vector of threshold values for every time-point
  in <code>range</code>.</p>
    <h2 class="hasAnchor" id="details">
<a class="anchor" href="#details"></a>Details</h2>

    <p>A generalized likelihood ratio test based on the Poisson
  distribution is implemented where the means of the in-control and
  out-of-control states are computed by isotonic regression.</p>
<p>$$OutbreakP(s) = \prod_{t=1}^s \left( \frac{\hat{\mu}^{C1}(t)}{\hat{\mu}^D(t)} \right)^{x(t)}$$</p>
<p>where \(\hat{\mu}^{C1}(t)\) is the estimated mean obtained by
 uni-modal regression under the assumption of one change-point and
 \(\hat{\mu}^D(t)\) is the estimated result when there is no
 change-point (i.e. this is just the mean of all observations). Note
 that the contrasted hypothesis assume all means are equal until the
 change-point, i.e. this detection method is especially suited for
 detecting a shift from a relative constant mean. Hence, this is less
 suited for detection in diseases with strong seasonal endemic
 component. Onset of influenza detection is an example where this
 method works particular well.</p>
<p>In case <code>control$ret == "cases"</code> then a brute force numerical
 search for the number needed before alarm (NNBA) is performed. That
 is, given the past observations, whats the minimum number which would
 have caused an alarm? Note: Computing this might take a while because
 the search is done by sequentially increasing/decreasing the last
 observation by one for each time point in <code>control$range</code> and
 then calling the workhorse function of the algorithm again. The argument
 <code>control$maxUpperboundCases</code> controls the upper limit of this
 search (default is 1e5).
 Currently, even though the statistic has passed the threshold, the NNBA
 is still computed. After a few time instances what typically happens is
 that no matter the observed value we would have an alarm at this time point. In this case the value of NNBA is set to <code>NA</code>. Furthermore, the first time
 point is always <code>NA</code>, unless <code>k&lt;1</code>.</p>
    <h2 class="hasAnchor" id="source">
<a class="anchor" href="#source"></a>Source</h2>

    <p>The code is an extended R port of the Java code by Marianne
 Frisén and Linus Schiöler from the
 CASE project available under the GNU GPL License v3. See
 <a href="https://case.folkhalsomyndigheten.se/">https://case.folkhalsomyndigheten.se/</a> for further details on the CASE
 project.
 <!-- %% A manual on how to use an Excel implementation of the method -->
 <!-- %% is available at \url{http://economics.handels.gu.se/english/Units+and+Centra/statistical_research_unit/software}. --></p>
<p>An additional feature of the R code is that it contains a search for
 NNBA (see details).</p>
    <h2 class="hasAnchor" id="author">
<a class="anchor" href="#author"></a>Author</h2>

    <p>M. Höhle -- based on Java code by M. Frisen and
  L. Schiöler</p>
    <h2 class="hasAnchor" id="references">
<a class="anchor" href="#references"></a>References</h2>

    <p>Frisén, M., Andersson and Schiöler, L., (2009), Robust
outbreak surveillance of epidemics in Sweden, Statistics in
Medicine, 28(3):476-493.</p>
<p>Frisén, M. and Andersson, E., (2009) Semiparametric
Surveillance of Monotonic Changes, Sequential Analysis 28(4):434-454.</p>

    <h2 class="hasAnchor" id="examples">
<a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><code class="sourceCode R"><span class="co">#Use data from outbreakP manual (http://www.hgu.gu.se/item.aspx?id=16857)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">7</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">8</span>,<span class="fl">16</span>,<span class="fl">23</span>,<span class="fl">33</span>,<span class="fl">34</span>,<span class="fl">48</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>

<span class="co">#Generate sts object with these observations</span>
<span class="va">mysts</span> <span class="op">&lt;-</span> <span class="fu"><a href="sts-class.html">sts</a></span><span class="op">(</span><span class="va">y</span>, alarm<span class="op">=</span><span class="va">y</span><span class="op">*</span><span class="fl">0</span><span class="op">)</span>

<span class="co">#Run the algorithm and present results</span>
<span class="co">#Only the value of outbreakP statistic</span>
<span class="fu"><a href="stsSlot-generics.html">upperbound</a></span><span class="op">(</span><span class="fu"><a href="wrap.algo.html">outbreakP</a></span><span class="op">(</span><span class="va">mysts</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>range<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,k<span class="op">=</span><span class="fl">100</span>,
           ret<span class="op">=</span><span class="st">"value"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co">#Graphical illustration with number-needed-before-alarm (NNBA) upperbound.</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="wrap.algo.html">outbreakP</a></span><span class="op">(</span><span class="va">mysts</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>range<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,k<span class="op">=</span><span class="fl">100</span>,
           ret<span class="op">=</span><span class="st">"cases"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">res</span>,dx.upperbound<span class="op">=</span><span class="fl">0</span>,lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>,legend.opts<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Infected"</span>,
      <span class="st">"NNBA"</span>,<span class="st">"Outbreak"</span>,<span class="st">"Alarm"</span><span class="op">)</span>,horiz<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
</code></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="sticky-top">
    <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>

    </nav>
</div>
  </div>
</div>


      <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Maintained by <a href="http://www.imbe.med.uni-erlangen.de/cms/sebastian_meyer.html" class="external-link">Sebastian Meyer</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

