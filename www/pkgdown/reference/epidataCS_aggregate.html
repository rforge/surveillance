<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Conversion (aggregation) of "epidataCS" to "epidata" or "sts" — epidataCS_aggregate • surveillance</title>
<script src="../deps/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="../deps/bs3compat-0.2.4/tabs.js"></script><script src="../deps/bs3compat-0.2.4/bs3compat.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css">
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<link href="../syntax-highlighting.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Conversion (aggregation) of " epidatacs to or epidatacs_aggregate>
<meta property="og:description" content='Continuous-time continuous-space epidemic data stored in an object of
  class "epidataCS" can be aggregated in space or in space
  and time yielding an object of class "epidata" or
  "sts" for use of twinSIR or
  hhh4 modelling, respectively.'>
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@bastistician">
<meta name="twitter:site" content="@bastistician">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc" data-headroom>
    

      <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a class="navbar-brand mb-0 h1" href="../index.html">surveillance</a>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <button type="button" id="version-badge" class="badge badge-default d-none d-lg-block" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Released version">1.19.1</button>

    <div id="navbar" class="collapse navbar-collapse">
      <ul class="navbar-nav mr-auto ml-3">
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/overview.html">Overview</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/events.html">Events</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/bibliography.html">Bibliography</a>
</li>
      </ul>
<ul class="navbar-nav ml-1"></ul>
</div>
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <div class="col-md-9 contents">
    <img src="" class="pkg-logo" alt=""><div class="page-header pb-2 mt-4 mb-2 border-bottom toc-ignore">
    <h1 class="display-4">Conversion (aggregation) of <code>"epidataCS"</code> to <code>"epidata"</code> or <code>"sts"</code>
</h1>
    
    <div class="d-none name"><code>epidataCS_aggregate.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Continuous-time continuous-space epidemic data stored in an object of
  class <code>"<a href="epidataCS.html">epidataCS</a>"</code> can be aggregated in space or in space
  and time yielding an object of class <code>"<a href="epidata.html">epidata</a>"</code> or
  <code>"<a href="sts-class.html">sts</a>"</code> for use of <code><a href="twinSIR.html">twinSIR</a></code> or
  <code><a href="hhh4.html">hhh4</a></code> modelling, respectively.</p>
    </div>

    <pre class="usage"><code class="sourceCode R"><span class="co">## aggregation in space and time over 'stgrid' for use of 'hhh4' models</span>
<span class="fu">epidataCS2sts</span><span class="op">(</span><span class="va">object</span>, <span class="va">freq</span>, <span class="va">start</span>, <span class="va">neighbourhood</span>,
              tiles <span class="op">=</span> <span class="cn">NULL</span>, popcol.stgrid <span class="op">=</span> <span class="cn">NULL</span>, popdensity <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co">## aggregation in space for use of 'twinSIR' models</span>
<span class="co"># S3 method for epidataCS</span>
<span class="fu"><a href="epidata.html">as.epidata</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">tileCentroids</span>, eps <span class="op">=</span> <span class="fl">0.001</span>, <span class="va">...</span><span class="op">)</span></code></pre>

    <h2>Arguments</h2>
    <dl class="row" id="ref-arguments">
<dt class="col-sm-3" id="ref-arguments name">object, data</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>an object of class <code>"<a href="epidataCS.html">epidataCS</a>"</code>.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">freq,start</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>see the description of the <code>"<a href="sts-class.html">sts</a>"</code> class.
    The <code>start</code> specification should reflect the beginning of
    <code>object$stgrid</code>, i.e., the start of the first time interval.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">neighbourhood</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>binary adjacency or neighbourhood-order matrix of the regions
    (<code>tiles</code>). If missing but <code>tiles</code> is given, a binary
    adjacency matrix will be auto-generated from <code>tiles</code> using
    functionality of the <span class="pkg">spdep</span> package (see
    <code><a href="poly2adjmat.html">poly2adjmat</a></code>).
    Since the <code>"neighbourhood"</code> slot in <code>"<a href="sts-class.html">sts</a>"</code>
    is actually optional, <code>neighbourhood=NULL</code> also works.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">tiles</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>object inheriting from <code>"SpatialPolygons"</code>
    representing the regions in <code>object$stgrid</code> (column
    <code>"tile"</code>). It will become the <code>"map"</code> slot of the
    resulting <code>"sts"</code> object.
    Its <code>row.names</code> must match <code><a href="https://rdrr.io/r/base/levels.html">levels(object$stgrid$tile)</a></code>.
    If <code>neighbourhood</code> is provided, <code>tiles</code> is optional (not
    required for <code>hhh4</code>, but for plots of the resulting
    <code>"sts"</code> object).</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">popcol.stgrid</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>single character or numeric value indexing the
    column in <code>object$stgrid</code> which contains the population data
    (counts or densities, depending on the <code>popdensity</code> argument).
    This will become the <code>"populationFrac"</code> slot (optional).</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">popdensity</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>logical indicating if the column referenced by
    <code>popcol.stgrid</code> contains population densities or absolute counts.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">tileCentroids</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>a coordinate matrix of the region centroids (i.e., the result of
    <code>coordinates(tiles)</code>). Its row names must match
    <code><a href="https://rdrr.io/r/base/levels.html">levels(data$stgrid$tile)</a></code>.
    This will be the coordinates used for the “population” (i.e.,
    the <code>tiles</code> from <code>"<a href="epidataCS.html">epidataCS</a>"</code>) in the
    discrete-space <code><a href="twinSIR.html">twinSIR</a></code> modelling.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">eps</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>numeric scalar for breaking tied removal and infection times between different
    individuals (tiles), which might occur during conversion from
    <code>"epidataCS"</code> to <code>"epidata"</code>. Rather dumb, this is simply done
    by subtracting <code>eps</code> from each tied removal time.
    One should consider other ways of breaking the tied event times.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">...</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>unused (argument of the generic).</p></dd>
    </dl>
<h2 class="hasAnchor" id="details">
<a class="anchor" href="#details"></a>Details</h2>

    <p>Conversion to <code>"<a href="sts-class.html">sts</a>"</code> only makes sense if the time
  intervals (<code>BLOCK</code>s) of the <code>stgrid</code> are regularly spaced
  (to give <code>freq</code> intervals per year). Note that events of the
  prehistory (not covered by <code>stgrid</code>) are not included in the
  resulting <code>sts</code> object.</p>  
<p>Some comments on the conversion to <code>"epidata"</code>:
  the conversion results into SIS epidemics only,
  i.e. the at-risk indicator is set to 1 immediately after
  recovery. A tile is considered infective if at least one individual
  within the tile is infective, otherwise it is susceptible.
  The lengths of the infectious periods are taken from
  <code>data$events$eps.t</code>. There will be no <code>f</code> columns in the resulting
  <code>"epidata"</code>. These must be generated by a subsequent call to
  <code><a href="epidata.html">as.epidata</a></code> with desired <code>f</code>.</p>
    <h2 class="hasAnchor" id="value">
<a class="anchor" href="#value"></a>Value</h2>

    <p><code>epidataCS2sts</code>: an object of class <code>"<a href="sts-class.html">sts</a>"</code>
  representing the multivariate time-series of the number of
  cases aggregated over <code>stgrid</code>.</p>
<p><code>as.epidata.epidataCS</code>: an object of class
  <code>"<a href="epidata.html">epidata</a>"</code> representing an SIS epidemic in form of a
  multivariate point process (one for each region/<code>tile</code>).</p>
    <h2 class="hasAnchor" id="author">
<a class="anchor" href="#author"></a>Author</h2>

    <p>Sebastian Meyer</p>
    <h2 class="hasAnchor" id="see-also">
<a class="anchor" href="#see-also"></a>See also</h2>

    <div class="dont-index">
<p><code><a href="epidata.html">epidata</a></code> and <code><a href="twinSIR.html">twinSIR</a></code></p>
<p><code>linkS4class{sts}</code> and <code><a href="hhh4.html">hhh4</a></code>.</p>
</div>

    <h2 class="hasAnchor" id="examples">
<a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"imdepi"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"shapes"</span>, <span class="st">"districtsD.RData"</span>, package<span class="op">=</span><span class="st">"surveillance"</span><span class="op">)</span><span class="op">)</span>

<span class="co">## convert imdepi point pattern into multivariate time series</span>
<span class="va">imdsts</span> <span class="op">&lt;-</span> <span class="fu">epidataCS2sts</span><span class="op">(</span><span class="va">imdepi</span>, freq <span class="op">=</span> <span class="fl">12</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2002</span>, <span class="fl">1</span><span class="op">)</span>,
                        neighbourhood <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># not needed here</span>
                        tiles <span class="op">=</span> <span class="va">districtsD</span><span class="op">)</span>

<span class="co">## check the overall number of events by district</span>
<span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="fu"><a href="stsSlots.html">observed</a></span><span class="op">(</span><span class="va">imdsts</span><span class="op">)</span><span class="op">)</span>,
                    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">imdepi</span><span class="op">$</span><span class="va">events</span><span class="op">$</span><span class="va">tile</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co">## compare plots of monthly number of cases</span>
<span class="va">opar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">imdepi</span>, <span class="st">"time"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">imdsts</span>, type <span class="op">=</span> <span class="va">observed</span> <span class="op">~</span> <span class="va">time</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">opar</span><span class="op">)</span>

<span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="surveillance.options.html">surveillance.options</a></span><span class="op">(</span><span class="st">"allExamples"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="co">## plot number of cases by district</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">imdsts</span>, type <span class="op">=</span> <span class="va">observed</span> <span class="op">~</span> <span class="va">unit</span><span class="op">)</span>
<span class="op">}</span>


<span class="co">## also test conversion to an SIS event history ("epidata") of the "tiles"</span>
<span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"intervals"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">imdepi_short</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">imdepi</span>, <span class="va">time</span> <span class="op">&lt;</span> <span class="fl">50</span><span class="op">)</span>  <span class="co"># to reduce the runtime</span>
    <span class="va">imdepi_short</span><span class="op">$</span><span class="va">stgrid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">imdepi_short</span><span class="op">$</span><span class="va">stgrid</span>, <span class="va">start</span> <span class="op">&lt;</span> <span class="fl">50</span><span class="op">)</span>
    <span class="va">imdepidata</span> <span class="op">&lt;-</span> <span class="fu"><a href="epidata.html">as.epidata</a></span><span class="op">(</span><span class="va">imdepi_short</span>,
                             tileCentroids <span class="op">=</span> <span class="fu">coordinates</span><span class="op">(</span><span class="va">districtsD</span><span class="op">)</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">imdepidata</span><span class="op">)</span>
<span class="op">}</span>
</code></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="sticky-top">
    <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>

    </nav>
</div>
  </div>
</div>


      <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Maintained by <a href="http://www.imbe.med.uni-erlangen.de/cms/sebastian_meyer.html" class="external-link">Sebastian Meyer</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001. Hosted on <a href="https://R-forge.R-project.org/projects/surveillance/" class="external-link"><img src="https://r-forge.r-project.org/themes/rforge/imagesrf/logo.png" height="18" alt="R-Forge"></a></p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

