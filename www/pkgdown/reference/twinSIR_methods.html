<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Print, Summary and Extraction Methods for "twinSIR" Objects — twinSIR_methods • surveillance</title>
<script src="../deps/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="../deps/bs3compat-0.2.4/tabs.js"></script><script src="../deps/bs3compat-0.2.4/bs3compat.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css">
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<link href="../syntax-highlighting.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Print, Summary and Extraction Methods for " twinsir objects twinsir_methods>
<meta property="og:description" content="Besides print and summary methods there are also some standard
extraction methods defined for objects of class &quot;twinSIR&quot;:
vcov, logLik and especially AIC and
extractAIC, which extract Akaike's Information Criterion.  Note that
special care is needed, when fitting models with parameter constraints such as
the epidemic effects \(\alpha\) in twinSIR models.  Parameter
constraints reduce the average increase in the maximized loglikelihood - thus
the penalty for constrained parameters should be smaller than the factor 2 used
in the ordinary definition of AIC.  To this end, these two methods offer the
calculation of the so-called one-sided AIC (OSAIC).">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@bastistician">
<meta name="twitter:site" content="@bastistician">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc" data-headroom>
    

      <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a class="navbar-brand mb-0 h1" href="../index.html">surveillance</a>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <button type="button" id="version-badge" class="badge badge-default d-none d-lg-block" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Released version">1.19.1</button>

    <div id="navbar" class="collapse navbar-collapse">
      <ul class="navbar-nav mr-auto ml-3">
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/overview.html">Overview</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/events.html">Events</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/bibliography.html">Bibliography</a>
</li>
      </ul>
<ul class="navbar-nav ml-1"></ul>
</div>
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <div class="col-md-9 contents">
    <img src="" class="pkg-logo" alt=""><div class="page-header pb-2 mt-4 mb-2 border-bottom toc-ignore">
    <h1 class="display-4">Print, Summary and Extraction Methods for <code>"twinSIR"</code> Objects</h1>
    
    <div class="d-none name"><code>twinSIR_methods.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Besides <code>print</code> and <code>summary</code> methods there are also some standard
extraction methods defined for objects of class <code>"twinSIR"</code>:
<code>vcov</code>, <code>logLik</code> and especially <code>AIC</code> and
<code>extractAIC</code>, which extract Akaike's Information Criterion.  Note that
special care is needed, when fitting models with parameter constraints such as
the epidemic effects \(\alpha\) in <code>twinSIR</code> models.  Parameter
constraints reduce the average increase in the maximized loglikelihood - thus
the penalty for constrained parameters should be smaller than the factor 2 used
in the ordinary definition of AIC.  To this end, these two methods offer the
calculation of the so-called one-sided AIC (OSAIC).</p>
    </div>

    <pre class="usage"><code class="sourceCode R"><span class="co"># S3 method for twinSIR</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x</span>, digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/options.html">getOption</a></span><span class="op">(</span><span class="st">"digits"</span><span class="op">)</span> <span class="op">-</span> <span class="fl">3</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span>
<span class="co"># S3 method for twinSIR</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">object</span>,
        correlation <span class="op">=</span> <span class="cn">FALSE</span>, symbolic.cor <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for twinSIR</span>
<span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span>, k <span class="op">=</span> <span class="fl">2</span>, one.sided <span class="op">=</span> <span class="cn">NULL</span>, nsim <span class="op">=</span> <span class="fl">1e3</span><span class="op">)</span>
<span class="co"># S3 method for twinSIR</span>
<span class="fu"><a href="https://rdrr.io/r/stats/extractAIC.html">extractAIC</a></span><span class="op">(</span><span class="va">fit</span>, scale <span class="op">=</span> <span class="fl">0</span>, k <span class="op">=</span> <span class="fl">2</span>, one.sided <span class="op">=</span> <span class="cn">NULL</span>,
           nsim <span class="op">=</span> <span class="fl">1e3</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for twinSIR</span>
<span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span>
<span class="co"># S3 method for twinSIR</span>
<span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for summary.twinSIR</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x</span>,
      digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/options.html">getOption</a></span><span class="op">(</span><span class="st">"digits"</span><span class="op">)</span> <span class="op">-</span> <span class="fl">3</span><span class="op">)</span>, symbolic.cor <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">symbolic.cor</span>,
      signif.stars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html">getOption</a></span><span class="op">(</span><span class="st">"show.signif.stars"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></code></pre>

    <h2>Arguments</h2>
    <dl class="row" id="ref-arguments">
<dt class="col-sm-3" id="ref-arguments name">x, object, fit</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>an object of class <code>"twinSIR"</code>.<br>
    For the <code>print</code> method of the <code>summary</code> method, an object of
    class <code>"summary.twinSIR"</code>.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">digits</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>integer, used for number formatting with <code><a href="https://rdrr.io/r/base/Round.html">signif()</a></code>.  Minimum number of
    significant digits to be printed in values.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">correlation</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>logical. if <code>TRUE</code>, the correlation matrix of the estimated parameters
    is returned and printed.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">symbolic.cor</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>logical. If <code>TRUE</code>, print the correlations in a symbolic form (see
    <code>symnum</code>) rather than as numbers.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">...</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>For the <code>summary</code> method: arguments passed to
    <code>extractAIC.twinSIR</code>.<br>
    For the <code>AIC</code> method, optionally more fitted model objects.<br>
    For the <code>print</code>, <code>extractAIC</code>, <code>vcov</code> and
    <code>logLik</code> methods: unused (argument of the generic).</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">k</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>numeric specifying the "weight" of the <em>penalty</em> to be used;
    in an unconstrained fit <code>k = 2</code> is the classical AIC.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">one.sided</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>logical or <code>NULL</code> (the default).  Determines if the one-sided AIC
    should be calculated instead of using the classical penalty <code>k*edf</code>. 
    The default value <code>NULL</code> chooses classical AIC in the case of an
    unconstrained fit and one-sided AIC in the case of constraints. The type of
    the fit can be seen in <code>object$method</code> (or <code>fit$method</code>
    respectively), where <code>"L-BFGS"</code> means constrained optimization.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">nsim</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>when there are more than two epidemic covariates in the fit, the
    weights in the OSAIC formula have to be determined by simulation. 
    Default is to use 1000 samples. Note that package <span class="pkg">quadprog</span> is
    additionally required in this case.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">scale</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>unused (argument of the generic).</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">signif.stars</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>logical. If <code>TRUE</code>, “significance
      stars” are printed for each coefficient.</p></dd>
    </dl>
<h2 class="hasAnchor" id="details">
<a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>print</code> and <code>summary</code> methods allow the compact or comprehensive
  representation of the fitting results, respectively.  The former only prints
  the original function call, the estimated coefficients and the maximum
  log-likelihood value.  The latter prints the whole coefficient matrix with
  standard errors, z- and p-values (see <code><a href="https://rdrr.io/r/stats/printCoefmat.html">printCoefmat</a></code>), and 
  additionally the number of infections per log-baseline <code>interval</code>, 
  the (one-sided) AIC and the number of log-likelihood evaluations.  They both
  append a big “WARNING”, if the optimization algorithm did not converge.</p>
<p>The estimated coefficients may be extracted by using the default
  <code>coef</code>-method from package <span class="pkg">stats</span>.</p>    
<p>The two AIC functions differ only in that <code>AIC</code> can take more than one
  fitted model object and that <code>extractAIC</code> always returns the number of
  parameters in the model (<code>AIC</code> only does with more than one fitted model
  object).</p>  
<p>Concerning the choice of one-sided AIC: parameter constraints -- such as the
  non-negative constraints for the epidemic effects alpha in <code>twinSIR</code>
  models -- reduce the average increase in the maximized loglikelihood.  Thus,
  the penalty for constrained parameters should be smaller than the factor 2
  used in the ordinary definition of AIC.  One-sided AIC (OSAIC) suggested by
  Hughes and King (2003) is such a proposal when \(p\) out of \(k = p + q\)
  parameters have non-negative constraints:
  $$OSAIC = -2 l(\theta, \tau) + 2 \sum_{g=0}^p w(p,g) (k-p+g)$$
  where \(w(p,g)\) are \(p\)-specific weights.  For more details see
  Section 5.2 in Höhle (2009).</p>
    <h2 class="hasAnchor" id="value">
<a class="anchor" href="#value"></a>Value</h2>

    <p>The <code>print</code> methods return their first argument, invisibly, as
  they always should. The <code>vcov</code> and <code>logLik</code>
  methods return the estimated variance-covariance
  matrix of the parameters (here, the inverse of the estimate of the
  expected Fisher information matrix), and the maximum log-likelihood
  value of the model, respectively.
  The <code>summary</code> method returns a list containing some summary
  statistics of the fitted model, which is nicely printed by the
  corresponding <code>print</code> method.
  For the <code><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></code> and <code><a href="https://rdrr.io/r/stats/extractAIC.html">extractAIC</a></code> methods, see
  the documentation of the corresponding generic functions.</p>
    <h2 class="hasAnchor" id="references">
<a class="anchor" href="#references"></a>References</h2>

    <p>Hughes A, King M (2003)
  Model selection using AIC in the presence of one-sided information.
  <em>Journal of Statistical Planning and Inference</em> <strong>115</strong>,
  pp. 397--411.</p>
<p>Höhle, M. (2009),
  Additive-Multiplicative Regression Models for Spatio-Temporal
  Epidemics, Biometrical Journal, 51(6):961-978.</p>
    <h2 class="hasAnchor" id="author">
<a class="anchor" href="#author"></a>Author</h2>

    <p>Michael Höhle and Sebastian Meyer</p>

    <h2 class="hasAnchor" id="examples">
<a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"hagelloch"</span><span class="op">)</span>

<span class="co"># a simplistic twinSIR model</span>
<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="twinSIR.html">twinSIR</a></span><span class="op">(</span><span class="op">~</span> <span class="va">household</span> <span class="op">+</span> <span class="fu"><a href="twinSIR_cox.html">cox</a></span><span class="op">(</span><span class="va">AGE</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">hagelloch</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span>, correlation <span class="op">=</span> <span class="cn">TRUE</span>, symbolic.cor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># AIC or OSAIC</span>
<span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="va">fit</span>, one.sided <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/extractAIC.html">extractAIC</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/extractAIC.html">extractAIC</a></span><span class="op">(</span><span class="va">fit</span>, one.sided <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># comparing models via AIC</span>
<span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">fit</span>, nIntervals <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">fit2</span><span class="op">)</span>   <span class="co"># the 2nd column should be named "OSAIC" here</span>
</code></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="sticky-top">
    <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>

    </nav>
</div>
  </div>
</div>


      <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Maintained by <a href="http://www.imbe.med.uni-erlangen.de/cms/sebastian_meyer.html" class="external-link">Sebastian Meyer</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001. Hosted on <a href="https://R-forge.R-project.org/projects/surveillance/" class="external-link"><img src="https://r-forge.r-project.org/themes/rforge/imagesrf/logo.png" height="18" alt="R-Forge"></a></p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

