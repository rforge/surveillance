<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Continuous Space-Time Marked Point Patterns with Grid-Based Covariates — epidataCS • surveillance</title>
<script src="../deps/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="../deps/bs3compat-0.2.4/tabs.js"></script><script src="../deps/bs3compat-0.2.4/bs3compat.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css">
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<link href="../syntax-highlighting.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Continuous Space-Time Marked Point Patterns with Grid-Based Covariates — epidataCS">
<meta property="og:description" content='Data structure for continuous spatio-temporal event
  data, e.g. individual case reports of an infectious disease.
  Apart from the actual events, the class simultaneously
  holds a spatio-temporal grid of endemic covariates (similar to
  disease mapping) and a representation of the observation region.
The "epidataCS" class is the basis for fitting 
  spatio-temporal endemic-epidemic intensity models with the function
  twinstim (Meyer et al., 2012).
  The implementation is described in Meyer et al. (2017, Section 3),
  see vignette("twinstim").'>
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@bastistician">
<meta name="twitter:site" content="@bastistician">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc" data-headroom>
    

      <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a class="navbar-brand mb-0 h1" href="../index.html">surveillance</a>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <button type="button" id="version-badge" class="badge badge-default d-none d-lg-block" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Released version">1.19.1</button>

    <div id="navbar" class="collapse navbar-collapse">
      <ul class="navbar-nav mr-auto ml-3">
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/overview.html">Overview</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/events.html">Events</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/bibliography.html">Bibliography</a>
</li>
      </ul>
<ul class="navbar-nav ml-1"></ul>
</div>
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <div class="col-md-9 contents">
    <img src="" class="pkg-logo" alt=""><div class="page-header pb-2 mt-4 mb-2 border-bottom toc-ignore">
    <h1 class="display-4">Continuous Space-Time Marked Point Patterns with Grid-Based Covariates</h1>
    
    <div class="d-none name"><code>epidataCS.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Data structure for <strong>c</strong>ontinuous <strong>s</strong>patio-temporal event
  data, e.g. individual case reports of an infectious disease.
  Apart from the actual <code>events</code>, the class simultaneously
  holds a spatio-temporal grid of endemic covariates (similar to
  disease mapping) and a representation of the observation region.</p>
<p>The <code>"epidataCS"</code> class is the basis for fitting 
  spatio-temporal endemic-epidemic intensity models with the function
  <code><a href="twinstim.html">twinstim</a></code> (Meyer et al., 2012).
  The implementation is described in Meyer et al. (2017, Section 3),
  see <code>vignette("twinstim")</code>.</p>
    </div>

    <pre class="usage"><code class="sourceCode R">as.epidataCS(events, stgrid, W, qmatrix = diag(nTypes),
             nCircle2Poly = 32L, T = NULL,
             clipper = c("polyclip", "rgeos"), verbose = interactive())

# S3 method for epidataCS
print(x, n = 6L, digits = getOption("digits"), ...)

# S3 method for epidataCS
nobs(object, ...)
# S3 method for epidataCS
head(x, n = 6L, ...)
# S3 method for epidataCS
tail(x, n = 6L, ...)
# S3 method for epidataCS
[(x, i, j, ..., drop = TRUE)
# S3 method for epidataCS
subset(x, subset, select, drop = TRUE, ...)

# S3 method for epidataCS
marks(x, coords = TRUE, ...)

# S3 method for epidataCS
summary(object, ...)
# S3 method for summary.epidataCS
print(x, ...)

# S3 method for epidataCS
as.stepfun(x, ...)

getSourceDists(object, dimension = c("space", "time"))</code></pre>

    <h2>Arguments</h2>
    <dl class="row" id="ref-arguments">
<dt class="col-sm-3" id="ref-arguments name">events</dt>
      <dd class="col-sm-9" id="ref-arguments desc">
<p>a <code>"SpatialPointsDataFrame"</code> of cases with the
    following obligatory columns (in the <code>events@data</code>
    <code>data.frame</code>):</p>
<dl>
<dt>time</dt>
<dd><p>time point of event. Will be converted to a numeric
        variable by <code>as.numeric</code>. There should be no concurrent
        events (but see <code><a href="untie.html">untie</a></code> for an ex post adjustment)
        and there cannot be events beyond <code>stgrid</code>
        (i.e., <code>time&lt;=T</code> is required). Events at or before time
        \(t_0\) = <code><a href="https://rdrr.io/r/base/Extremes.html">min(stgrid$start)</a></code> are allowed and form the
        prehistory of the process.</p></dd>
      <dt>tile</dt>
<dd><p>the spatial region (tile) where the event is located.
      This links to the tiles of <code>stgrid</code>.</p></dd>
      <dt>type</dt>
<dd><p>optional type of event in a marked <code>twinstim</code>
	model. Will be converted to a factor variable dropping unused
        levels. If missing, all events will be attribute the single type
        <code>"1"</code>.</p></dd>
      <dt>eps.t</dt>
<dd><p>maximum <em>temporal</em> influence radius (e.g. length of
	infectious period, time to culling, etc.); must be positive and
        may be <code>Inf</code>.</p></dd> 
      <dt>eps.s</dt>
<dd><p>maximum <em>spatial</em> influence radius (e.g. 100 [km]);
        must be positive and may be <code>Inf</code>. A compact influence
        region mainly has computational advantages, but might also be
        plausible for specific applications.</p></dd>
    
</dl>
<p>The <code>data.frame</code> may contain columns with further marks of
    the events, e.g. sex, age of infected individuals, which may
    be used as epidemic covariates influencing infectiousness.
    Note that some auxiliary columns will be added at conversion
    whose names are reserved: <code>".obsInfLength"</code>,
    <code>".bdist"</code>, <code>".influenceRegion"</code>, and <code>".sources"</code>,
    as well as <code>"start"</code>, <code>"BLOCK"</code>, and all endemic
    covariates' names from <code>stgrid</code>.</p>
</dd>
    <dt class="col-sm-3" id="ref-arguments name">stgrid</dt>
      <dd class="col-sm-9" id="ref-arguments desc">
<p>a <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></code> describing endemic covariates on a full
    spatio-temporal region x interval grid (e.g., district x week),
    which is a decomposition of the observation region <code>W</code> and
    period \(t_0,T\). This means that for every combination of spatial
    region and time interval there must be exactly one row in this
    <code>data.frame</code>, that the union of the spatial tiles equals
    <code>W</code>, the union of the time intervals equals \(t_0,T\), and
    that regions (and intervals) are non-overlapping.
    There are the following obligatory columns:</p>
<dl>
<dt>tile</dt>
<dd><p>ID of the spatial region (e.g., district ID). It will
        be converted to a factor variable (dropping unused levels if it
        already was one).</p></dd>
      <dt>start, stop</dt>
<dd><p>columns describing the consecutive temporal
        intervals (converted to numeric variables by <code>as.numeric</code>).
        The <code>start</code> time of an interval must be equal to the
        <code>stop</code> time of the previous interval. The <code>stop</code> column may
	be missing, in which case it will be auto-generated from the set
	of <code>start</code> values and <code>T</code>.</p></dd>
      <dt>area</dt>
<dd><p>area of the spatial region (<code>tile</code>).
	Be aware that the unit of this area (e.g., square km) must be consistent
	with the units of <code>W</code> and <code>events</code> (as specified in
	their <code>proj4string</code>s).</p></dd>
    
</dl>
<p>The remaining columns are endemic covariates.
    Note that the column name <code>"BLOCK"</code> is reserved
    (a column which will be added automatically for indexing the time
    intervals of <code>stgrid</code>).</p>
</dd>
    <dt class="col-sm-3" id="ref-arguments name">W</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>an object of class <code>"SpatialPolygons"</code>
    representing the observation region.
    It must have the same <code>proj4string</code> as <code>events</code>
    and all events must be within <code>W</code>.
    Prior simplification of <code>W</code> may considerably reduce the
    computational burden of likelihood evaluations in
    <code><a href="twinstim.html">twinstim</a></code> models with non-trivial spatial
    interaction functions (see the “Note” section below).</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">qmatrix</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>a square indicator matrix (0/1 or <code>FALSE</code>/<code>TRUE</code>) for possible
    transmission between the event types. The matrix will be internally
    converted to <code>logical</code>. Defaults to an independent spread of the event
    types, i.e. the identity matrix.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">nCircle2Poly</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>accuracy (number of edges) of the polygonal approximation of a circle,
    see <code><a href="discpoly.html">discpoly</a></code>.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">T</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>end of observation period (i.e. last <code>stop</code> time of
    <code>stgrid</code>). Must be specified if the start but not the stop
    times are supplied in <code>stgrid</code> (=&gt; auto-generation of
    <code>stop</code> times).</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">clipper</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>polygon clipping engine to use for calculating the
    <code>.influenceRegion</code>s of events (see the Value section below).
    Default is the <a href="https://CRAN.R-project.org/package=polyclip"><span class="pkg">polyclip</span></a> package (called via
    <code>intersect.owin</code> from package <a href="https://CRAN.R-project.org/package=spatstat.geom"><span class="pkg">spatstat.geom</span></a>).
    In <span class="pkg">surveillance</span> &lt;= 1.6-0, package <span class="pkg">gpclib</span> was used, which
    has a restrictive license. This is no longer supported.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">verbose</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>logical indicating if status messages should be printed
  during input checking and <code>"epidataCS"</code> generation. The default
  is to do so in interactive <span style="R">R</span> sessions.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">x</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>an object of class <code>"epidataCS"</code> or
    <code>"summary.epidataCS"</code>, respectively.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">n</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>a single integer. If positive, the first (<code>head</code>, <code>print</code>)
    / last (<code>tail</code>) <code>n</code> events are extracted. If negative,
    all but the <code>n</code> first/last events are extracted.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">digits</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>minimum number of significant digits to be printed in
    values.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">i,j,drop</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>arguments passed to the
    <code>[-method</code> for
    <code>SpatialPointDataFrame</code>s for subsetting the <code>events</code> while
    retaining <code>stgrid</code> and <code>W</code>.<br>
    If <code>drop=TRUE</code> (the default), event types that completely
    disappear due to <code>i</code>-subsetting will be dropped, which reduces
    <code>qmatrix</code> and the factor levels of the <code>type</code> column.<br>
    By the <code>j</code> index, epidemic covariates can be removed from
    <code>events</code>.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">...</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>unused (arguments of the generics) with a few exceptions:
    The <code>print</code> method for <code>"epidataCS"</code> passes
    <code>...</code> to the <code><a href="https://rdrr.io/r/base/print.dataframe.html">print.data.frame</a></code> method, and the
    <code>print</code> method for <code>"summary.epidataCS"</code> passes additional
    arguments to <code><a href="https://rdrr.io/r/base/print.html">print.table</a></code>.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">subset, select</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>arguments used to subset the <code>events</code> from
    an <code>"epidataCS"</code> object like in <code><a href="https://rdrr.io/r/base/subset.html">subset.data.frame</a></code>.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">coords</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>logical indicating if the data frame of event marks
    returned by <code><a href="marks.html">marks(x)</a></code> should have the event
    coordinates appended as last columns. This defaults to <code>TRUE</code>.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">object</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>an object of class <code>"epidataCS"</code>.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">dimension</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>the distances of all events to their potential source
    events can be computed in either the <code>"space"</code> or <code>"time"</code>
    dimension.</p></dd>
    </dl>
<h2 class="hasAnchor" id="details">
<a class="anchor" href="#details"></a>Details</h2>

    <p>The function <code>as.epidataCS</code> is used to generate objects of class
  <code>"epidataCS"</code>, which is the data structure required for
  <code><a href="twinstim.html">twinstim</a></code> models.</p>
<p>The <code><a href="https://rdrr.io/r/base/Extract.html">[</a></code>-method for class <code>"epidataCS"</code>
  ensures that the subsetted object will be valid, for instance, it
  updates the auxiliary list of potential transmission paths stored
  in the object. The <code><a href="https://rdrr.io/r/base/Extract.html">[</a></code>-method is used in
  <code>subset.epidataCS</code>, which is implemented similar to
  <code><a href="https://rdrr.io/r/base/subset.html">subset.data.frame</a></code>.</p>  
<p>The <code>print</code> method for <code>"epidataCS"</code> prints some metadata
  of the epidemic, e.g., the observation period, the dimensions of the
  spatio-temporal grid, the types of events, and the total number of
  events. By default, it also prints the first <code>n = 6</code> rows of the
  <code>events</code>.</p>
    <h2 class="hasAnchor" id="value">
<a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>"epidataCS"</code> is a list containing the
  following components:</p>
<dt>events</dt>
<dd>
<p>a <code>"SpatialPointsDataFrame"</code> (see the
    description of the argument). 
    The input <code>events</code> are checked for requirements and sorted
    chronologically. The columns are in the following
    order: obligatory event columns, event marks, the columns <code>BLOCK</code>,
    <code>start</code> and endemic covariates copied from <code>stgrid</code>,
    and finally, hidden auxiliary columns. 
    The added auxiliary columns are:
    </p>
<dl>
<dt><code>.obsInfLength</code></dt>
<dd><p>observed length of the infectious period
	(possibly truncated at <code>T</code>), i.e., <code><a href="https://rdrr.io/r/base/Extremes.html">pmin(T-time, eps.t)</a></code>.</p></dd>
      <dt><code>.sources</code></dt>
<dd><p>a list of numeric vectors of potential sources of
        infection (wrt the interaction ranges eps.s and eps.t) for each
        event. Row numbers are used as index.</p></dd>
      <dt><code>.bdist</code></dt>
<dd><p>minimal distance of the event locations to the
        polygonal boundary <code>W</code>.</p></dd>
      <dt><code>.influenceRegion</code></dt>
<dd><p>a list of influence regions represented by
        objects of the <span class="pkg">spatstat.geom</span> class <code>"owin"</code>. For each
        event, this is the intersection of <code>W</code> with a (polygonal)
        circle of radius <code>eps.s</code> centered at the event's location,
        shifted such that the event location becomes the origin.
        The list has <code>nCircle2Poly</code> set as an attribute.</p></dd>
</dl>
</dd>
  <dt>stgrid</dt>
<dd><p>a <code>data.frame</code> (see description of the argument).
    The spatio-temporal grid of endemic covariates is sorted by time
    interval (indexed by the added variable <code>BLOCK</code>) and region
    (<code>tile</code>). It is a full <code>BLOCK</code> x <code>tile</code> grid.</p></dd>
  <dt>W</dt>
<dd><p>a <code>"SpatialPolygons"</code> object representing
    the observation region.</p></dd>
  <dt>qmatrix</dt>
<dd><p>see the above description of the argument. The
    <code><a href="https://rdrr.io/r/base/mode.html">storage.mode</a></code> of the indicator matrix is set to logical
    and the <code>dimnames</code> are set to the levels of the event types.</p></dd>

  The nobs-method returns the number of events.

  The head and tail methods subset the epidemic data using
  the extraction method ([), i.e. they return an object of class
  "epidataCS", which only contains (all but) the first/last
  n events.

  For the "epidataCS" class, the method of the generic function
  <a href="https://rdrr.io/pkg/spatstat.geom/man/marks.html">marks</a> defined by the spatstat.geom package
  returns a data.frame of the event marks (actually also
  including time and location of the events), disregarding endemic
  covariates and the auxiliary columns from the events component
  of the "epidataCS" object.

  The summary method (which has again a print method)
  returns a list of metadata, event data, the tables of tiles and types,
  a step function of the number of infectious individuals over time
  ($counter), i.e., the result of the
  <a href="https://rdrr.io/r/stats/stepfun.html">as.stepfun</a>-method for "epidataCS", and the number
  of potential sources of transmission for each event ($nSources)
  which is based on the given maximum interaction ranges eps.t
  and eps.s.

    <h2 class="hasAnchor" id="note">
<a class="anchor" href="#note"></a>Note</h2>

    <p>Since the observation region <code>W</code> defines the integration domain
  in the point process likelihood,
  the more detailed the polygons of <code>W</code> are the longer it will
  take to fit a <code><a href="twinstim.html">twinstim</a></code>. You are advised to
  sacrifice some shape details for speed by reducing the polygon
  complexity, for example via the <code class="command">mapshaper</code> JavaScript library
  wrapped by the R package <a href="https://CRAN.R-project.org/package=rmapshaper"><span class="pkg">rmapshaper</span></a>.
  Alternative tools are provided by the packages <a href="https://CRAN.R-project.org/package=maptools"><span class="pkg">maptools</span></a>
  (<code><a href="http://maptools.r-forge.r-project.org/reference/thinnedSpatialPoly.html">thinnedSpatialPoly</a></code>) and <a href="https://CRAN.R-project.org/package=spatstat.geom"><span class="pkg">spatstat.geom</span></a>
  (<code><a href="https://rdrr.io/pkg/spatstat.geom/man/simplify.owin.html">simplify.owin</a></code>).</p>
    <h2 class="hasAnchor" id="references">
<a class="anchor" href="#references"></a>References</h2>

    <p>Meyer, S., Elias, J. and Höhle, M. (2012):
  A space-time conditional intensity model for invasive meningococcal
  disease occurrence. <em>Biometrics</em>, <b>68</b>, 607-616.
  doi: <a href="https://doi.org/10.1111/j.1541-0420.2011.01684.x">10.1111/j.1541-0420.2011.01684.x</a></p>
<p>Meyer, S., Held, L. and Höhle, M. (2017):
  Spatio-temporal analysis of epidemic phenomena using the <span style="R">R</span> package
  <span class="pkg">surveillance</span>.
  <em>Journal of Statistical Software</em>, <b>77</b> (11), 1-55.
  doi: <a href="https://doi.org/10.18637/jss.v077.i11">10.18637/jss.v077.i11</a></p>
    <h2 class="hasAnchor" id="author">
<a class="anchor" href="#author"></a>Author</h2>

    <p>Sebastian Meyer</p>
<p>Contributions to this documentation by Michael
  Höhle and Mayeul Kauffmann.</p>
    <h2 class="hasAnchor" id="see-also">
<a class="anchor" href="#see-also"></a>See also</h2>

    <div class="dont-index">
<p><code>vignette("twinstim")</code>.</p>
<p><code><a href="epidataCS_plot.html">plot.epidataCS</a></code> for plotting, and
  <code><a href="epidataCS_animate.html">animate.epidataCS</a></code> for the animation of such an epidemic.
  There is also an <code><a href="epidataCS_update.html">update</a></code> method for the
  <code>"epidataCS"</code> class.</p>
<p>To re-extract the <code>events</code> point pattern from <code>"epidataCS"</code>,
  use <code>as(object, "SpatialPointsDataFrame")</code>.</p>
<p>It is possible to convert an <code>"epidataCS"</code> point pattern to
  an <code>"<a href="epidata.html">epidata</a>"</code> object (<code><a href="epidataCS_aggregate.html">as.epidata.epidataCS</a></code>),
  or to aggregate the events into an <code>"<a href="sts-class.html">sts</a>"</code> object
  (<code><a href="epidataCS_aggregate.html">epidataCS2sts</a></code>).</p>
</div>

    <h2 class="hasAnchor" id="examples">
<a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><code class="sourceCode R"><span class="co">## load "imdepi" example data (which is an object of class "epidataCS")</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"imdepi"</span><span class="op">)</span>

<span class="co">## print and summary</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">imdepi</span>, n<span class="op">=</span><span class="fl">5</span>, digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">imdepi</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">counter</span>,  <span class="co"># same as 'as.stepfun(imdepi)'</span>
     xlab <span class="op">=</span> <span class="st">"Time [days]"</span>, ylab<span class="op">=</span><span class="st">"Number of infectious individuals"</span>,
     main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Time course of the number of infectious individuals"</span>,
                <span class="st">"assuming an infectious period of 30 days"</span>, sep<span class="op">=</span><span class="st">"\n"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">nSources</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"Number of \"close\" infective individuals"</span>,
     ylab<span class="op">=</span><span class="st">"Number of events"</span>,
     main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Distribution of the number of potential sources"</span>,
                <span class="st">"assuming an interaction range of 200 km and 30 days"</span>,
                sep<span class="op">=</span><span class="st">"\n"</span><span class="op">)</span><span class="op">)</span>
<span class="co">## the summary object contains further information</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span>

<span class="co">## a histogram of the spatial distances to potential source events</span>
<span class="co">## (i.e., to events of the previous eps.t=30 days within eps.s=200 km)</span>
<span class="va">sourceDists_space</span> <span class="op">&lt;-</span> <span class="fu">getSourceDists</span><span class="op">(</span><span class="va">imdepi</span>, <span class="st">"space"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">sourceDists_space</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/rug.html">rug</a></span><span class="op">(</span><span class="va">sourceDists_space</span><span class="op">)</span>

<span class="co">## internal structure of an "epidataCS"-object</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">imdepi</span>, max.level<span class="op">=</span><span class="fl">4</span><span class="op">)</span>
<span class="co">## see help("imdepi") for more info on the data set</span>

<span class="co">## extraction methods subset the 'events' component</span>
<span class="co">## (thereby taking care of the validity of the epidataCS object,</span>
<span class="co">## for instance the hidden auxiliary column .sources)</span>
<span class="va">imdepi</span><span class="op">[</span><span class="fl">101</span><span class="op">:</span><span class="fl">200</span>,<span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">imdepi</span>, n<span class="op">=</span><span class="fl">4</span><span class="op">)</span>           <span class="co"># reduce the epidemic to the last 4 events</span>
<span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">imdepi</span>, <span class="va">type</span><span class="op">==</span><span class="st">"B"</span><span class="op">)</span>   <span class="co"># only consider event type B</span>

<span class="co">## see help("plot.epidataCS") for convenient plot-methods for "epidataCS"</span>


<span class="co">###</span>
<span class="co">### reconstruct the "imdepi" object</span>
<span class="co">###</span>

<span class="co">## observation region</span>
<span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"shapes"</span>, <span class="st">"districtsD.RData"</span>, package<span class="op">=</span><span class="st">"surveillance"</span><span class="op">)</span>,
     verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">stateD</span><span class="op">)</span>

<span class="co">## extract point pattern of events from the "imdepi" data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">imdepi</span><span class="op">)</span>
<span class="va">events</span> <span class="op">&lt;-</span> <span class="fu"><a href="marks.html">marks</a></span><span class="op">(</span><span class="va">imdepi</span><span class="op">)</span>  <span class="co"># data frame with coordinate columns</span>
<span class="fu">coordinates</span><span class="op">(</span><span class="va">events</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>  <span class="co"># promote to a "SpatialPointsDataFrame"</span>
<span class="co">#proj4string(events) &lt;- proj4string(stateD)</span>
<span class="va">events</span><span class="op">@</span><span class="va">proj4string</span> <span class="op">&lt;-</span> <span class="va">stateD</span><span class="op">@</span><span class="va">proj4string</span>  <span class="co"># exact copy (avoid CRS reformatting)</span>

<span class="co">## or, much simpler, use the corresponding coerce-method</span>
<span class="co"># \dontshow{</span>
<span class="va">events</span><span class="op">@</span><span class="va">coords.nrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="fl">0L</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="fu">as</span><span class="op">(</span><span class="va">imdepi</span>, <span class="st">"SpatialPointsDataFrame"</span><span class="op">)</span>, <span class="va">events</span><span class="op">)</span><span class="op">)</span>
<span class="co"># }</span>
<span class="va">events</span> <span class="op">&lt;-</span> <span class="fu">as</span><span class="op">(</span><span class="va">imdepi</span>, <span class="st">"SpatialPointsDataFrame"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">events</span><span class="op">)</span>

<span class="co">## plot observation region with events</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">stateD</span>, axes<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span>xlab<span class="op">=</span><span class="st">"x [km]"</span>, ylab<span class="op">=</span><span class="st">"y [km]"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">events</span>, pch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/class.html">unclass</a></span><span class="op">(</span><span class="va">events</span><span class="op">$</span><span class="va">type</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">0.5</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/class.html">unclass</a></span><span class="op">(</span><span class="va">events</span><span class="op">$</span><span class="va">type</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">events</span><span class="op">$</span><span class="va">type</span><span class="op">)</span>, title<span class="op">=</span><span class="st">"Type"</span>, pch<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, col<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>

<span class="co">## space-time grid with endemic covariates</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">stgrid</span> <span class="op">&lt;-</span> <span class="va">imdepi</span><span class="op">$</span><span class="va">stgrid</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>

<span class="co">## reconstruct the "imdepi" object from its components</span>
<span class="va">myimdepi</span> <span class="op">&lt;-</span> <span class="fu">as.epidataCS</span><span class="op">(</span>events <span class="op">=</span> <span class="va">events</span>, stgrid <span class="op">=</span> <span class="va">stgrid</span>,
                         W <span class="op">=</span> <span class="va">stateD</span>, qmatrix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, nCircle2Poly <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>
<span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span>
<span class="co">## This reconstructed object is equal to 'imdepi' as long as the internal</span>
<span class="co">## structures of the embedded classes ("owin", "SpatialPolygons", ...), and</span>
<span class="co">## the calculation of the influence regions by "polyclip" have not changed:</span>
<span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">imdepi</span>, <span class="va">myimdepi</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
</code></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="sticky-top">
    <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>

    </nav>
</div>
  </div>
</div>


      <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Maintained by <a href="http://www.imbe.med.uni-erlangen.de/cms/sebastian_meyer.html" class="external-link">Sebastian Meyer</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001. Hosted on <a href="https://R-forge.R-project.org/projects/surveillance/" class="external-link"><img src="https://r-forge.r-project.org/themes/rforge/imagesrf/logo.png" height="18" alt="R-Forge"></a></p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

