<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>The Bayes System — algo.bayes • surveillance</title>
<script src="../deps/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="../deps/bs3compat-0.2.4/tabs.js"></script><script src="../deps/bs3compat-0.2.4/bs3compat.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css">
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<link href="../syntax-highlighting.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="The Bayes System — algo.bayes">
<meta property="og:description" content="Evaluation of timepoints with the Bayes subsystem
        1, 2, 3 or a self defined Bayes subsystem.">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@bastistician">
<meta name="twitter:site" content="@bastistician">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc" data-headroom data-tolerance="5" data-offset="100">
    

      <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a class="navbar-brand mb-0 h1" href="../index.html">surveillance</a>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <button type="button" id="version-badge" class="badge badge-default d-none d-lg-block" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Released version">1.19.1</button>

    <div id="navbar" class="collapse navbar-collapse">
      <ul class="navbar-nav mr-auto ml-3">
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/overview.html">Overview</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/events.html">Events</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/bibliography.html">Bibliography</a>
</li>
      </ul>
<ul class="navbar-nav ml-1"></ul>
</div>
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header pb-2 mt-4 mb-2 border-bottom toc-ignore">
    <h1 class="display-4">The Bayes System</h1>
    
    <div class="d-none name"><code>algo.bayes.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Evaluation of timepoints with the Bayes subsystem
        1, 2, 3 or a self defined Bayes subsystem.</p>
    </div>

    <pre class="usage"><code class="sourceCode R"><span class="fu">algo.bayesLatestTimepoint</span><span class="op">(</span><span class="va">disProgObj</span>, timePoint <span class="op">=</span> <span class="cn">NULL</span>,
       control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>b <span class="op">=</span> <span class="fl">0</span>, w <span class="op">=</span> <span class="fl">6</span>, actY <span class="op">=</span> <span class="cn">TRUE</span>,alpha<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span><span class="op">)</span>
  <span class="fu">algo.bayes</span><span class="op">(</span><span class="va">disProgObj</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>range <span class="op">=</span> <span class="va">range</span>,
       b <span class="op">=</span> <span class="fl">0</span>, w <span class="op">=</span> <span class="fl">6</span>, actY <span class="op">=</span> <span class="cn">TRUE</span>,alpha<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span><span class="op">)</span>
  <span class="fu">algo.bayes1</span><span class="op">(</span><span class="va">disProgObj</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>range <span class="op">=</span> <span class="va">range</span><span class="op">)</span><span class="op">)</span>
  <span class="fu">algo.bayes2</span><span class="op">(</span><span class="va">disProgObj</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>range <span class="op">=</span> <span class="va">range</span><span class="op">)</span><span class="op">)</span>
  <span class="fu">algo.bayes3</span><span class="op">(</span><span class="va">disProgObj</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>range <span class="op">=</span> <span class="va">range</span><span class="op">)</span><span class="op">)</span></code></pre>

    <h2>Arguments</h2>
    <dl class="row" id="ref-arguments">
<dt class="col-sm-3" id="ref-arguments name">disProgObj</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>object of class disProg (including the observed and the state chain)</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">timePoint</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>time point which should be evaluated in
	  <code>algo.bayes LatestTimepoint</code>. The
                default is to use the latest timepoint</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">control</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>control object: <code>range</code> determines the desired
                timepoints which should be evaluated, <code>b</code> describes the number of years to go
                back for the reference values, <code>w</code> is the half window width for the reference
                values around the appropriate timepoint and <code>actY</code> is a boolean to decide if
                the year of <code>timePoint</code> also contributes <code>w</code> reference values. The parameter <code>alpha</code> is the \((1-\alpha)\)-quantile to use in order to calculate the upper threshold.
                As default <code>b</code>, <code>w</code>, <code>actY</code> are set for the Bayes 1 system with <code>alpha</code>=0.05.</p></dd>
    </dl>
<h2 class="hasAnchor" id="value">
<a class="anchor" href="#value"></a>Value</h2>

    

<dt>survRes</dt>
<dd><p><code>algo.bayesLatestTimepoint</code> returns a list of class <code>survRes</code> (surveillance result), which
    includes the alarm value for recognizing an
    outbreak (1 for alarm, 0 for no alarm), the threshold value for recognizing the alarm and
    the input object of class disProg.
    <code>algo.bayes</code> gives a list of class <code>survRes</code> which includes the vector
    of alarm values for every timepoint in <code>range</code> and the vector of threshold values
    for every timepoint in <code>range</code> for the system specified by <code>b</code>, <code>w</code> and
    <code>actY</code>, the range and the input object of class disProg.
    <code>algo.bayes1</code> returns the same for the Bayes 1 system, <code>algo.bayes2</code>
    for the Bayes 2 system and <code>algo.bayes3</code> for the Bayes 3 system.</p></dd>

    <h2 class="hasAnchor" id="details">
<a class="anchor" href="#details"></a>Details</h2>

    <p>Using the reference values the \((1-\alpha)\cdot
    100\%\) quantile of the
  predictive posterior distribution is calculated as a threshold.
  An alarm is given if the actual value is bigger or equal than this threshold.
  It is possible to show using analytical computations that the predictive
  posterior in this case is the negative
  binomial distribution. Note: <code>algo.rki</code> or <code>algo.farrington</code>
  use two-sided prediction intervals -- if one wants to compare with
  these procedures it is necessary to use an alpha, which is half the
  one used for these procedures.</p>
<p>Note also that <code>algo.bayes</code> calls
  <code>algo.bayesLatestTimepoint</code> for the values specified in
  <code>range</code> and for the system specified in <code>control</code>.
  <code>algo.bayes1</code>, <code>algo.bayes2</code>, <code>algo.bayes3</code> call
  <code>algo.bayesLatestTimepoint</code> for the values specified in
  <code>range</code> for the Bayes 1 system, Bayes 2 system or Bayes 3 system.</p>
<p></p>
<ul>
<li><p><code>"Bayes 1"</code> reference values from 6 weeks. Alpha is fixed a
 t 0.05.</p></li>
<li><p><code>"Bayes 2"</code> reference values from 6 weeks ago and
    13 weeks of the previous year (symmetrical around the
    same week as the current one in the previous year). Alpha is fixed at 0.05.</p></li>
<li><p><code>"Bayes 3"</code>  18 reference values. 9 from the year ago
    and 9 from two years ago (also symmetrical around the
    comparable week). Alpha is fixed at 0.05.</p></li>
</ul>
<p>The procedure is now able to handle <code>NA</code>'s in the reference
  values. In the summation and when counting the number of observed
  reference values these are simply not counted.</p>
    <h2 class="hasAnchor" id="see-also">
<a class="anchor" href="#see-also"></a>See also</h2>

    <div class="dont-index"><p><code><a href="algo.call.html">algo.call</a></code>, <code><a href="algo.rki.html">algo.rkiLatestTimepoint</a></code> and <code><a href="algo.rki.html">algo.rki</a></code> for
        the RKI system.</p></div>
    <h2 class="hasAnchor" id="author">
<a class="anchor" href="#author"></a>Author</h2>

    <p>M. Höhle, A. Riebler, C. Lang</p>
    <h2 class="hasAnchor" id="source">
<a class="anchor" href="#source"></a>Source</h2>

    <p>Riebler, A. (2004), Empirischer Vergleich von statistischen Methoden zur
Ausbruchserkennung bei Surveillance Daten, Bachelor's thesis.</p>

    <h2 class="hasAnchor" id="examples">
<a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><code class="sourceCode R">    <span class="va">disProg</span> <span class="op">&lt;-</span> <span class="fu"><a href="sim.pointSource.html">sim.pointSource</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.99</span>, r <span class="op">=</span> <span class="fl">0.5</span>, length <span class="op">=</span> <span class="fl">208</span>, A <span class="op">=</span> <span class="fl">1</span>,
                                    alpha <span class="op">=</span> <span class="fl">1</span>, beta <span class="op">=</span> <span class="fl">0</span>, phi <span class="op">=</span> <span class="fl">0</span>,
                                    frequency <span class="op">=</span> <span class="fl">1</span>, state <span class="op">=</span> <span class="cn">NULL</span>, K <span class="op">=</span> <span class="fl">1.7</span><span class="op">)</span>

    <span class="co"># Test for bayes 1 the latest timepoint</span>
    <span class="fu">algo.bayesLatestTimepoint</span><span class="op">(</span><span class="va">disProg</span><span class="op">)</span>

    <span class="co"># Test week 200 to 208 for outbreaks with a selfdefined bayes</span>
    <span class="fu">algo.bayes</span><span class="op">(</span><span class="va">disProg</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>range <span class="op">=</span> <span class="fl">200</span><span class="op">:</span><span class="fl">208</span>, b <span class="op">=</span> <span class="fl">1</span>,
                                                w <span class="op">=</span> <span class="fl">5</span>, actY <span class="op">=</span> <span class="cn">TRUE</span>,alpha<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span><span class="op">)</span>
    <span class="co"># The same for bayes 1 to bayes 3</span>
    <span class="fu">algo.bayes1</span><span class="op">(</span><span class="va">disProg</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>range <span class="op">=</span> <span class="fl">200</span><span class="op">:</span><span class="fl">208</span>,alpha<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span><span class="op">)</span>
    <span class="fu">algo.bayes2</span><span class="op">(</span><span class="va">disProg</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>range <span class="op">=</span> <span class="fl">200</span><span class="op">:</span><span class="fl">208</span>,alpha<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span><span class="op">)</span>
    <span class="fu">algo.bayes3</span><span class="op">(</span><span class="va">disProg</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>range <span class="op">=</span> <span class="fl">200</span><span class="op">:</span><span class="fl">208</span>,alpha<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span><span class="op">)</span>
</code></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="sticky-top">
    <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>

    </nav>
</div>
  </div>
</div>


      <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Maintained by <a href="http://www.imbe.med.uni-erlangen.de/cms/sebastian_meyer.html" class="external-link">Sebastian Meyer</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

