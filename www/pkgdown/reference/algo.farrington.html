<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Surveillance for Count Time Series Using the Classic Farrington Method — algo.farrington • surveillance</title>
<script src="../deps/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="../deps/bs3compat-0.2.4/tabs.js"></script><script src="../deps/bs3compat-0.2.4/bs3compat.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css">
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<link href="../syntax-highlighting.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Surveillance for Count Time Series Using the Classic Farrington Method — algo.farrington">
<meta property="og:description" content="The function takes range values of the surveillance time
  series disProgObj and for each time point uses a GLM to
  predict the number of counts according to the procedure by
  Farrington et al. (1996). This is then compared to the observed
  number of counts. If the observation is above a specific quantile of
  the prediction interval, then an alarm is raised.">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@bastistician">
<meta name="twitter:site" content="@bastistician">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc" data-headroom data-tolerance="5" data-offset="100">
    

      <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a class="navbar-brand mb-0 h1" href="../index.html">surveillance</a>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <button type="button" id="version-badge" class="badge badge-default d-none d-lg-block" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Released version">1.19.1</button>

    <div id="navbar" class="collapse navbar-collapse">
      <ul class="navbar-nav mr-auto ml-3">
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/overview.html">Overview</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/events.html">Events</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/bibliography.html">Bibliography</a>
</li>
      </ul>
<ul class="navbar-nav ml-1"></ul>
</div>
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header pb-2 mt-4 mb-2 border-bottom toc-ignore">
    <h1 class="display-4">Surveillance for Count Time Series Using the Classic Farrington Method</h1>
    
    <div class="d-none name"><code>algo.farrington.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function takes <code>range</code> values of the surveillance time
  series <code>disProgObj</code> and for each time point uses a GLM to
  predict the number of counts according to the procedure by
  Farrington et al. (1996). This is then compared to the observed
  number of counts. If the observation is above a specific quantile of
  the prediction interval, then an alarm is raised.</p>
    </div>

    <pre class="usage"><code class="sourceCode R"><span class="fu">algo.farrington</span><span class="op">(</span><span class="va">disProgObj</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    range<span class="op">=</span><span class="cn">NULL</span>, b<span class="op">=</span><span class="fl">5</span>, w<span class="op">=</span><span class="fl">3</span>, reweight<span class="op">=</span><span class="cn">TRUE</span>, verbose<span class="op">=</span><span class="cn">FALSE</span>, plot<span class="op">=</span><span class="cn">FALSE</span>,
    alpha<span class="op">=</span><span class="fl">0.05</span>, trend<span class="op">=</span><span class="cn">TRUE</span>, limit54<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">4</span><span class="op">)</span>, powertrans<span class="op">=</span><span class="st">"2/3"</span>,
    fitFun<span class="op">=</span><span class="st">"algo.farrington.fitGLM.fast"</span><span class="op">)</span><span class="op">)</span></code></pre>

    <h2>Arguments</h2>
    <dl class="row" id="ref-arguments">
<dt class="col-sm-3" id="ref-arguments name">disProgObj</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>object of class disProgObj (including the <code>observed</code> and the
    <code>state</code> time series.)</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">control</dt>
      <dd class="col-sm-9" id="ref-arguments desc">
<p>list of control parameters</p>
<dl>
<dt><code>range</code></dt>
<dd><p>Specifies the index of all timepoints which
        should be tested. If range is <code>NULL</code> the maximum number
        of possible weeks is used (i.e. as many weeks as possible while
	still having enough reference values).</p></dd>
    <dt><code>b</code></dt>
<dd><p>how many years back in time to include when
        forming the base counts.</p></dd>
    <dt><code>w</code></dt>
<dd><p>windows size, i.e. number of weeks to include
        before and after the current week</p></dd>
    <dt><code>reweight</code></dt>
<dd><p>Boolean specifying whether to perform reweight step</p></dd>
    <dt><code>trend</code></dt>
<dd><p>If <code>TRUE</code> a trend is included and kept in
        case the conditions documented in Farrington et al. (1996) are met
        (see the results). If <code>FALSE</code> then NO trend is fit.</p></dd>
    <dt><code>verbose</code></dt>
<dd><p>Boolean indicating whether to show extra debugging information.</p></dd>
    <dt><code>plot</code></dt>
<dd><p>Boolean specifying whether to show the final GLM model fit graphically (use
        History|Recording to see all pictures).</p></dd>
    <dt><code>powertrans</code></dt>
<dd><p>Power transformation to apply to the
        data. Use either "2/3" for skewness correction (Default),
        "1/2" for variance stabilizing transformation or "none" for no
        transformation.</p></dd>
    <dt><code>alpha</code></dt>
<dd><p>An approximate (two-sided) \((1-\alpha)\)
        prediction interval is calculated.</p></dd>
    <dt><code>limit54</code></dt>
<dd><p>To avoid alarms in cases where the time series only
        has about 0-2 cases the algorithm uses the following heuristic
        criterion (see Section 3.8 of the Farrington paper) to protect
        against low counts: no alarm is sounded if fewer than
        \(cases=5\) reports were received in the past \(period=4\)
        weeks. <code>limit54=c(cases,period)</code> is a vector allowing the
        user to change these numbers. Note: As of version 0.9-7 the
        term "last" period of weeks includes the current week -
        otherwise no alarm is sounded for horrible large numbers if
        the four weeks before that are too low.</p></dd>
    <dt><code>fitFun</code></dt>
<dd><p>String containing the name of the fit
        function to be used for fitting the GLM. The options are
        <code>algo.farrington.fitGLM.fast</code> (default) and
        <code>algo.farrington.fitGLM</code> or 
        <code>algo.farrington.fitGLM.populationOffset</code>. See details of
        <code><a href="algo.farrington.fitGLM.html">algo.farrington.fitGLM</a></code> for more information.</p></dd>
      
</dl>
<p></p>
</dd>
    </dl>
<h2 class="hasAnchor" id="details">
<a class="anchor" href="#details"></a>Details</h2>

    <p>The following steps are performed according to the Farrington
  et al. (1996) paper.</p>
<ol>
<li><p>fit of the initial model and initial estimation of mean and
  overdispersion.</p></li>
<li><p>calculation of the weights omega (correction for past outbreaks)</p></li>
<li><p>refitting of the model</p></li>
<li><p>revised estimation of overdispersion</p></li>
<li><p>rescaled model</p></li>
<li><p>omission of the trend, if it is not significant</p></li>
<li><p>repetition of the whole procedure</p></li>
<li><p>calculation of the threshold value</p></li>
<li><p>computation of exceedance score</p></li>
</ol>
<h2 class="hasAnchor" id="value">
<a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>"survRes"</code>.</p>
    <h2 class="hasAnchor" id="author">
<a class="anchor" href="#author"></a>Author</h2>

    <p>M. Höhle</p>
    <h2 class="hasAnchor" id="see-also">
<a class="anchor" href="#see-also"></a>See also</h2>

    <div class="dont-index">
<p><code><a href="algo.farrington.fitGLM.html">algo.farrington.fitGLM</a></code>,
  <code><a href="algo.farrington.threshold.html">algo.farrington.threshold</a></code></p>
<p>An improved Farrington algorithm is available as function
  <code><a href="farringtonFlexible.html">farringtonFlexible</a></code>.</p>
</div>
    <h2 class="hasAnchor" id="references">
<a class="anchor" href="#references"></a>References</h2>

    <p>A statistical algorithm for the early detection of outbreaks of
  infectious disease, Farrington, C.P., Andrews, N.J, Beale A.D. and
  Catchpole, M.A. (1996), J. R. Statist. Soc. A, 159, 547-563.</p>

    <h2 class="hasAnchor" id="examples">
<a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><code class="sourceCode R"><span class="co">#Read Salmonella Agona data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"salmonella.agona"</span><span class="op">)</span>

<span class="co">#Do surveillance for the last 100 weeks.</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">salmonella.agona</span><span class="op">$</span><span class="va">observed</span><span class="op">)</span>
<span class="co">#Set control parameters.</span>
<span class="va">control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>b<span class="op">=</span><span class="fl">4</span>,w<span class="op">=</span><span class="fl">3</span>,range<span class="op">=</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">100</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>,reweight<span class="op">=</span><span class="cn">TRUE</span>, verbose<span class="op">=</span><span class="cn">FALSE</span>,alpha<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">algo.farrington</span><span class="op">(</span><span class="va">salmonella.agona</span>,control<span class="op">=</span><span class="va">control</span><span class="op">)</span>
<span class="co">#Plot the result.</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">res</span>,disease<span class="op">=</span><span class="st">"Salmonella Agona"</span>,method<span class="op">=</span><span class="st">"Farrington"</span><span class="op">)</span>

<span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span>
<span class="co">#Generate Poisson counts and convert into an "sts" object</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="fl">520</span>,lambda<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="va">sts</span> <span class="op">&lt;-</span> <span class="fu"><a href="sts-class.html">sts</a></span><span class="op">(</span>observed<span class="op">=</span><span class="va">x</span>, state<span class="op">=</span><span class="va">x</span><span class="op">*</span><span class="fl">0</span>, freq<span class="op">=</span><span class="fl">52</span><span class="op">)</span>

<span class="co">#Compare timing of the two possible fitters for algo.farrington (here using S4)</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span> <span class="va">sts1</span> <span class="op">&lt;-</span> <span class="fu"><a href="wrap.algo.html">farrington</a></span><span class="op">(</span><span class="va">sts</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>range<span class="op">=</span><span class="fl">312</span><span class="op">:</span><span class="fl">520</span>,
                       fitFun<span class="op">=</span><span class="st">"algo.farrington.fitGLM.fast"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span> <span class="va">sts2</span> <span class="op">&lt;-</span> <span class="fu"><a href="wrap.algo.html">farrington</a></span><span class="op">(</span><span class="va">sts</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>range<span class="op">=</span><span class="fl">312</span><span class="op">:</span><span class="fl">520</span>,
                       fitFun<span class="op">=</span><span class="st">"algo.farrington.fitGLM"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co">#Check if results are the same</span>
<span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="stsSlot-generics.html">upperbound</a></span><span class="op">(</span><span class="va">sts1</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="stsSlot-generics.html">upperbound</a></span><span class="op">(</span><span class="va">sts2</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
</code></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="sticky-top">
    <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>

    </nav>
</div>
  </div>
</div>


      <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Maintained by <a href="http://www.imbe.med.uni-erlangen.de/cms/sebastian_meyer.html" class="external-link">Sebastian Meyer</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

