<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Animated Maps and Time Series of Disease Counts or Incidence — sts_animate • surveillance</title>
<script src="../deps/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="../deps/bs3compat-0.2.4/tabs.js"></script><script src="../deps/bs3compat-0.2.4/bs3compat.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css">
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<link href="../syntax-highlighting.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Animated Maps and Time Series of Disease Counts or Incidence — sts_animate">
<meta property="og:description" content="The animate-method for sts objects
  supersedes the stsplot type observed~1|unit*time
  implemented by the function stsplot_spacetime.
  Maps generated by stsplot_space are
  sequentially plotted along time (optionally showing cumulative
  counts/incidence), with an optional time series chart below the map
  to track the epidemic curve.
  It is worth using functionality of the animation package
  (e.g., saveHTML) to directly export the
  animation into a useful format.
  See Meyer and Held (2014, Supplement A) for an example with the
  fluBYBW data.">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@bastistician">
<meta name="twitter:site" content="@bastistician">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc" data-headroom>
    

      <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a class="navbar-brand mb-0 h1" href="../index.html">surveillance</a>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <button type="button" id="version-badge" class="badge badge-default d-none d-lg-block" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Released version">1.19.1</button>

    <div id="navbar" class="collapse navbar-collapse">
      <ul class="navbar-nav mr-auto ml-3">
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/overview.html">Overview</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/events.html">Events</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/bibliography.html">Bibliography</a>
</li>
      </ul>
<ul class="navbar-nav ml-1"></ul>
</div>
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <div class="col-md-9 contents">
    <img src="" class="pkg-logo" alt=""><div class="page-header pb-2 mt-4 mb-2 border-bottom toc-ignore">
    <h1 class="display-4">Animated Maps and Time Series of Disease Counts or Incidence</h1>
    
    <div class="d-none name"><code>sts_animate.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>animate</code>-method for <code><a href="sts-class.html">sts</a></code> objects
  supersedes the <code><a href="stsplot.html">stsplot</a></code> type <code>observed~1|unit*time</code>
  implemented by the function <code><a href="stsplot_spacetime.html">stsplot_spacetime</a></code>.
  Maps generated by <code><a href="stsplot_space.html">stsplot_space</a></code> are
  sequentially plotted along time (optionally showing cumulative
  counts/incidence), with an optional time series chart below the map
  to track the epidemic curve.
  It is worth using functionality of the <span class="pkg">animation</span> package
  (e.g., <code><a href="https://rdrr.io/pkg/animation/man/saveHTML.html">saveHTML</a></code>) to directly export the
  animation into a useful format.
  See Meyer and Held (2014, Supplement A) for an example with the
  <code><a href="fluBYBW.html">fluBYBW</a></code> data.</p>
    </div>

    <pre class="usage"><code class="sourceCode R"><span class="co"># S3 method for sts</span>
<span class="fu"><a href="animate.html">animate</a></span><span class="op">(</span><span class="va">object</span>, tps <span class="op">=</span> <span class="cn">NULL</span>, cumulative <span class="op">=</span> <span class="cn">FALSE</span>,
        population <span class="op">=</span> <span class="cn">NULL</span>, at <span class="op">=</span> <span class="fl">10</span>, <span class="va">...</span>,
        timeplot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>pos <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">0.3</span>, fill <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
        sleep <span class="op">=</span> <span class="fl">0.5</span>, verbose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interactive.html">interactive</a></span><span class="op">(</span><span class="op">)</span>, draw <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre>

    <h2>Arguments</h2>
    <dl class="row" id="ref-arguments">
<dt class="col-sm-3" id="ref-arguments name">object</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>an object of class <code>"<a href="sts-class.html">sts</a>"</code> or a matrix of counts,
    i.e., <code><a href="stsSlots.html">observed(stsObj)</a></code>, where especially
    <code><a href="https://rdrr.io/r/base/colnames.html">colnames(x)</a></code> have to be contained in <code><a href="https://rdrr.io/r/base/row.names.html">row.names(map)</a></code>.
    If a matrix, the <code>map</code> object has to be provided explicitly (as
    part of <code>...</code>).</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">tps</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>a numeric vector of one or more time points at which to plot the map.
    The default <code>tps=NULL</code> means the whole time period <code>1:nrow(object)</code>.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">cumulative</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>logical specifying if the cumulative counts/incidence over time
    should be plotted. The cumulative incidence is relative to the
    population from the first time point <code>tps[1]</code> throughout the
    whole animation, while <code>cumulative=FALSE</code> computes the
    incidence from the current population numbers.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">population,at,...</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>arguments for <code><a href="stsplot_space.html">stsplot_space</a></code>.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">timeplot</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>if a list and package <a href="https://CRAN.R-project.org/package=gridExtra"><span class="pkg">gridExtra</span></a> is available,
    a time series chart of the counts along
    the selected time points <code>tps</code> will be plotted next to the map.
    The list elements determine both the positioning of this plot
    (<code>pos</code>, <code>size</code>, and <code>fill</code>) and its appearance.
    The default <code>pos=1</code> and <code>size=0.3</code> arguments put the time
    series plot below the map, using 30% of the total plot height.
    The logical value <code>fill</code> indicates whether to make the panel as
    big as possible (default: TRUE). An alternative to <code>fill=FALSE</code>
    is to manually specify an <code>aspect</code> (ratio) value in <code>timeplot</code>.
    Other list elements are arguments for the internal (and currently
    undocumented) function <code>stsplot_timeSimple</code>. For example,
    <code>inactive</code> and <code>active</code> are lists of graphical parameters
    (e.g., <code>col</code>) determining the appearance of the bars (e.g.,
    default color is grey when inactive and black when active),
    and the boolean <code>as.Date</code> determines whether dates should be
    put on the x-axis (instead of the <code>tps</code> indexes).</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">sleep</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>time to wait (<code>Sys.sleep</code>) between subsequent snapshots (only if
    <code><a href="https://rdrr.io/r/grDevices/dev.interactive.html">dev.interactive</a></code>), in seconds.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">verbose</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>logical indicating if a <code><a href="https://rdrr.io/r/utils/txtProgressBar.html">txtProgressBar</a></code> should be shown
    during generation of the animation -- which may take a while.
    Default is to do so in <code><a href="https://rdrr.io/r/base/interactive.html">interactive</a></code> sessions.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">draw</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>logical indicating if the produced plots at each time point should
    be drawn directly (the default) or not.
    The setting <code>draw = FALSE</code> is useful if one would like to
    manually arrange the plots, which are always returned invisibly in a
    list of length <code><a href="https://rdrr.io/r/base/length.html">length(tps)</a></code>.</p></dd>
    </dl>
<h2 class="hasAnchor" id="value">
<a class="anchor" href="#value"></a>Value</h2>

    <p>(invisibly) a list of the <code><a href="https://rdrr.io/r/base/length.html">length(tps)</a></code> sequential plot objects.
  These are of class <code>"gtable"</code> (from <a href="https://CRAN.R-project.org/package=gtable"><span class="pkg">gtable</span></a>)
  if the <code>timeplot</code> is included, otherwise of class
  <code>"\code{<a href="https://rdrr.io/pkg/lattice/man/trellis.object.html">trellis</a>"</code>.</p>
    <h2 class="hasAnchor" id="references">
<a class="anchor" href="#references"></a>References</h2>

    <p>Meyer, S. and Held, L. (2014):
  Power-law models for infectious disease spread.
  <em>The Annals of Applied Statistics</em>, <b>8</b> (3), 1612-1639.
  doi: <a href="https://doi.org/10.1214/14-AOAS743">10.1214/14-AOAS743</a>
.<br>
  Supplement A is available from
  <a href="https://www.biostat.uzh.ch/static/powerlaw/">https://www.biostat.uzh.ch/static/powerlaw/</a>.</p>
    <h2 class="hasAnchor" id="author">
<a class="anchor" href="#author"></a>Author</h2>

    <p>Sebastian Meyer</p>
    <h2 class="hasAnchor" id="see-also">
<a class="anchor" href="#see-also"></a>See also</h2>

    <div class="dont-index"><p>the other plot types documented in <code><a href="stsplot.html">stsplot</a></code> for static
  time series plots and maps.</p></div>

    <h2 class="hasAnchor" id="examples">
<a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"measlesWeserEms"</span><span class="op">)</span>

<span class="co">## animate the weekly counts of measles (during weeks 12-16 only, for speed)</span>
<span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="st"><a href="https://yihui.name/animation">"animation"</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">oldwd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>  <span class="co"># to not clutter up the current working dir</span>
    <span class="fu"><a href="https://rdrr.io/pkg/animation/man/saveHTML.html">saveHTML</a></span><span class="op">(</span><span class="fu"><a href="animate.html">animate</a></span><span class="op">(</span><span class="va">measlesWeserEms</span>, tps<span class="op">=</span><span class="fl">12</span><span class="op">:</span><span class="fl">16</span><span class="op">)</span>,
             title<span class="op">=</span><span class="st">"Evolution of the measles epidemic in the Weser-Ems region"</span>,
             ani.width<span class="op">=</span><span class="fl">500</span>, ani.height<span class="op">=</span><span class="fl">600</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span><span class="op">(</span><span class="va">oldwd</span><span class="op">)</span>
<span class="op">}</span>

<span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span>
<span class="co">## animate the weekly incidence of measles (per 100'000 inhabitants),</span>
<span class="co">## and label the time series plot with dates in a specified format</span>
<span class="fu"><a href="animate.html">animate</a></span><span class="op">(</span><span class="va">measlesWeserEms</span>, tps<span class="op">=</span><span class="fl">12</span><span class="op">:</span><span class="fl">16</span>,
        population <span class="op">=</span> <span class="va">measlesWeserEms</span><span class="op">@</span><span class="va">map</span><span class="op">$</span><span class="va">POPULATION</span> <span class="op">/</span> <span class="fl">100000</span>,
        timeplot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>as.Date <span class="op">=</span> <span class="cn">TRUE</span>,
                        scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"%G/%V"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
</code></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="sticky-top">
    <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>

    </nav>
</div>
  </div>
</div>


      <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Maintained by <a href="http://www.imbe.med.uni-erlangen.de/cms/sebastian_meyer.html" class="external-link">Sebastian Meyer</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001. Hosted on <a href="https://R-forge.R-project.org/projects/surveillance/" class="external-link"><img src="https://r-forge.r-project.org/themes/rforge/imagesrf/logo.png" height="18" alt="R-Forge"></a></p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

