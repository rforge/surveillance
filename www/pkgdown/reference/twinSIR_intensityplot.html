<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Plotting Paths of Infection Intensities for twinSIR Models — twinSIR_intensityplot • surveillance</title>
<script src="../deps/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="../deps/bs3compat-0.2.4/tabs.js"></script><script src="../deps/bs3compat-0.2.4/bs3compat.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css">
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<link href="../syntax-highlighting.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Plotting Paths of Infection Intensities for twinSIR Models — twinSIR_intensityplot">
<meta property="og:description" content='intensityplot methods to plot the evolution of the total infection
intensity, its epidemic proportion or its endemic proportion over time.
The default plot method for objects of class "twinSIR"
is just a wrapper for the intensityplot method.
The implementation is illustrated in Meyer et al. (2017, Section 4),
see vignette("twinSIR").'>
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@bastistician">
<meta name="twitter:site" content="@bastistician">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc" data-headroom>
    

      <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a class="navbar-brand mb-0 h1" href="../index.html">surveillance</a>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <button type="button" id="version-badge" class="badge badge-default d-none d-lg-block" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Released version">1.19.1</button>

    <div id="navbar" class="collapse navbar-collapse">
      <ul class="navbar-nav mr-auto ml-3">
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/overview.html">Overview</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/events.html">Events</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/pkgdown/bibliography.html">Bibliography</a>
</li>
      </ul>
<ul class="navbar-nav ml-1"></ul>
</div>
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <div class="col-md-9 contents">
    <img src="" class="pkg-logo" alt=""><div class="page-header pb-2 mt-4 mb-2 border-bottom toc-ignore">
    <h1 class="display-4">Plotting Paths of Infection Intensities for <code>twinSIR</code> Models</h1>
    
    <div class="d-none name"><code>twinSIR_intensityplot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code><a href="intensityplot.html">intensityplot</a></code> methods to plot the evolution of the total infection
intensity, its epidemic proportion or its endemic proportion over time.
The default <code>plot</code> method for objects of class <code>"twinSIR"</code>
is just a wrapper for the <code>intensityplot</code> method.
The implementation is illustrated in Meyer et al. (2017, Section 4),
see <code>vignette("twinSIR")</code>.</p>
    </div>

    <pre class="usage"><code class="sourceCode R"><span class="co"># S3 method for twinSIR</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"epidemic proportion"</span>, <span class="st">"endemic proportion"</span>,
     <span class="st">"total intensity"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for twinSIR</span>
<span class="fu"><a href="intensityplot.html">intensityplot</a></span><span class="op">(</span><span class="va">x</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"epidemic proportion"</span>, <span class="st">"endemic proportion"</span>,
              <span class="st">"total intensity"</span><span class="op">)</span>, aggregate <span class="op">=</span> <span class="cn">TRUE</span>, theta <span class="op">=</span> <span class="cn">NULL</span>,
              plot <span class="op">=</span> <span class="cn">TRUE</span>, add <span class="op">=</span> <span class="cn">FALSE</span>, rug.opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for simEpidata</span>
<span class="fu"><a href="intensityplot.html">intensityplot</a></span><span class="op">(</span><span class="va">x</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"epidemic proportion"</span>, <span class="st">"endemic proportion"</span>,
              <span class="st">"total intensity"</span><span class="op">)</span>, aggregate <span class="op">=</span> <span class="cn">TRUE</span>, theta <span class="op">=</span> <span class="cn">NULL</span>,
              plot <span class="op">=</span> <span class="cn">TRUE</span>, add <span class="op">=</span> <span class="cn">FALSE</span>, rug.opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></code></pre>

    <h2>Arguments</h2>
    <dl class="row" id="ref-arguments">
<dt class="col-sm-3" id="ref-arguments name">x</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>an object of class <code>"<a href="twinSIR.html">twinSIR</a>"</code> (fitted model) or
    <code>"<a href="twinSIR_simulation.html">simEpidata</a>"</code> (simulated <code>twinSIR</code> epidemic),
    respectively.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">which</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p><code>"epidemic proportion"</code>, <code>"endemic proportion"</code>,
    or <code>"total intensity"</code>.  Partial matching is applied.  Determines
    whether to plot the path of the total intensity \(\lambda(t)\) or its 
    epidemic or endemic proportions
    \(\frac{e(t)}{\lambda(t)}\) or
    \(\frac{h(t)}{\lambda(t)}\).</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">aggregate</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>logical. Determines whether lines for all individual infection
    intensities should be drawn (<code>FALSE</code>) or their sum only
    (<code>TRUE</code>, the default).</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">theta</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>numeric vector of model coefficients.  If <code>x</code> is of class
    <code>"twinSIR"</code>, then <code>theta = c(alpha, beta)</code>, where <code>beta</code>
    consists of the coefficients of the piecewise constant log-baseline function
    and the coefficients of the endemic (<code>cox</code>) predictor.  If <code>x</code> is
    of class <code>"simEpidata"</code>, then <code>theta = c(alpha, 1, betarest)</code>, 
    where 1 refers to the (true) log-baseline used in the simulation and 
    <code>betarest</code> is the vector of the remaining coefficients of the endemic 
    (<code>cox</code>) predictor.
    The default (<code>NULL</code>) means that the fitted or true parameters,
    respectively, will be used.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">plot</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>logical indicating if a plot is desired, defaults to <code>TRUE</code>.
    Otherwise, only the data of the plot will be returned.  Especially with
    <code>aggregate = FALSE</code> and many individuals one might e.g. consider to 
    plot a subset of the individual intensity paths only or do some further
    calculations/analysis of the infection intensities.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">add</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>logical.  If <code>TRUE</code>, paths are added to the current plot, using
    <code>lines</code>.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">rug.opts</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>either a list of arguments passed to the function <code><a href="https://rdrr.io/r/graphics/rug.html">rug</a></code>, or
    <code>NULL</code> (or <code>NA</code>), in which case no <code>rug</code> will be plotted.
    By default, the argument <code>ticksize</code> is set to 0.02 and <code>quiet</code>
    is set to <code>TRUE</code>.  Note that the argument <code>x</code> of the
    <code><a href="https://rdrr.io/r/graphics/rug.html">rug()</a></code> function, which contains the
    locations for the <code>rug</code> is fixed internally and can not be modified.
    The locations of the rug are the time points of infections.</p></dd>
    <dt class="col-sm-3" id="ref-arguments name">...</dt>
      <dd class="col-sm-9" id="ref-arguments desc"><p>For the <code>plot.twinSIR</code> method, arguments passed to
    <code>intensityplot.twinSIR</code>.
    For the <code>intensityplot</code> methods, further graphical parameters
    passed to the function <code><a href="https://rdrr.io/r/graphics/matplot.html">matplot</a></code>, 
    e.g. <code>lty</code>, <code>lwd</code>, <code>col</code>, <code>xlab</code>, <code>ylab</code> and
    <code>main</code>.  Note that the <code>matplot</code> arguments <code>x</code>, <code>y</code>,
    <code>type</code> and <code>add</code> are implicit and can not be specified here.</p></dd>
    </dl>
<h2 class="hasAnchor" id="value">
<a class="anchor" href="#value"></a>Value</h2>

    <p>numeric matrix with the first column <code>"stop"</code> and as many rows as there
  are <code>"stop"</code> time points in the event history <code>x</code>.  The other 
  columns depend on the argument <code>aggregate</code>: if <code>TRUE</code>, there 
  is only one other column named <code>which</code>, which contains the values of 
  <code>which</code> at the respective <code>"stop"</code> time points.  Otherwise, if
  <code>aggregate = FALSE</code>, there is one column for each individual, each of
  them containing the individual <code>which</code> at the respective <code>"stop"</code>
  time points.</p>
    <h2 class="hasAnchor" id="references">
<a class="anchor" href="#references"></a>References</h2>

    <p>Meyer, S., Held, L. and Höhle, M. (2017):
  Spatio-temporal analysis of epidemic phenomena using the <span style="R">R</span> package
  <span class="pkg">surveillance</span>.
  <em>Journal of Statistical Software</em>, <b>77</b> (11), 1-55.
  doi: <a href="https://doi.org/10.18637/jss.v077.i11">10.18637/jss.v077.i11</a></p>
    <h2 class="hasAnchor" id="author">
<a class="anchor" href="#author"></a>Author</h2>

    <p>Sebastian Meyer</p>
    <h2 class="hasAnchor" id="see-also">
<a class="anchor" href="#see-also"></a>See also</h2>

    <div class="dont-index"><p><code><a href="twinSIR.html">twinSIR</a></code> for a description of the intensity model, and
<code><a href="twinSIR_simulation.html">simulate.twinSIR</a></code> for the simulation of epidemic data
according to a <code>twinSIR</code> specification.</p></div>

    <h2 class="hasAnchor" id="examples">
<a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"hagelloch"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">hagelloch</span><span class="op">)</span>

<span class="co"># a simplistic twinSIR model</span>
<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="twinSIR.html">twinSIR</a></span><span class="op">(</span><span class="op">~</span> <span class="va">household</span>, data <span class="op">=</span> <span class="va">hagelloch</span><span class="op">)</span>

<span class="co"># overall total intensity</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">fit</span>, which <span class="op">=</span> <span class="st">"total"</span><span class="op">)</span>

<span class="co"># overall epidemic proportion</span>
<span class="va">epi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">fit</span>, which <span class="op">=</span> <span class="st">"epidemic"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">epi</span><span class="op">)</span>
<span class="co"># add overall endemic proportion = 1 - epidemic proportion</span>
<span class="va">ende</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">fit</span>, which <span class="op">=</span> <span class="st">"endemic"</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, legend <span class="op">=</span> <span class="st">"endemic proportion"</span>, lty <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fl">2</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span>

<span class="co"># individual intensities</span>
<span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">fit</span>, which <span class="op">=</span> <span class="st">"total"</span>, aggregate <span class="op">=</span> <span class="cn">FALSE</span>,
    col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,
    main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="st">"Individual infection intensities "</span> <span class="op">*</span>
        <span class="va">lambda</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="op">==</span> <span class="va">Y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="op">%.%</span> <span class="op">(</span><span class="va">e</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="va">h</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co"># return value: matrix of individual intensity paths</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span>

<span class="co"># plot intensity path only for individuals 3 and 99</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html">matplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">tmp</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">tmp</span><span class="op">[</span>,<span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">99</span><span class="op">)</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">"S"</span>,
        ylab <span class="op">=</span> <span class="st">"Force of infection"</span>, xlab <span class="op">=</span> <span class="st">"time"</span>,
        main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="st">"Paths of the infection intensities "</span> <span class="op">*</span>
                          <span class="va">lambda</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="op">*</span> <span class="st">" and "</span> <span class="op">*</span> <span class="va">lambda</span><span class="op">[</span><span class="fl">99</span><span class="op">]</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Individual"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">99</span><span class="op">)</span><span class="op">)</span>,
       col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>
</code></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="sticky-top">
    <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>

    </nav>
</div>
  </div>
</div>


      <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Maintained by <a href="http://www.imbe.med.uni-erlangen.de/cms/sebastian_meyer.html" class="external-link">Sebastian Meyer</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001. Hosted on <a href="https://R-forge.R-project.org/projects/surveillance/" class="external-link"><img src="https://r-forge.r-project.org/themes/rforge/imagesrf/logo.png" height="18" alt="R-Forge"></a></p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

